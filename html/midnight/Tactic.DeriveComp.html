<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Tactic.DeriveComp</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">-v</a> <a id="16" class="Pragma">allTactics:100</a> <a id="31" class="Symbol">#-}</a>
<a id="35" class="Symbol">{-#</a> <a id="39" class="Keyword">OPTIONS</a> <a id="47" class="Pragma">--safe</a> <a id="54" class="Symbol">#-}</a>
<a id="58" class="Keyword">module</a> <a id="65" href="Tactic.DeriveComp.html" class="Module">Tactic.DeriveComp</a> <a id="83" class="Keyword">where</a>

<a id="90" class="Keyword">open</a> <a id="95" class="Keyword">import</a> <a id="102" href="Prelude.html" class="Module">Prelude</a>
<a id="110" class="Keyword">open</a> <a id="115" class="Keyword">import</a> <a id="122" href="Meta.html" class="Module">Meta</a>

<a id="128" class="Keyword">import</a> <a id="135" href="Reflection.AST.Argument.Visibility.html" class="Module">Reflection.AST.Argument.Visibility</a> <a id="170" class="Symbol">as</a> <a id="173" class="Module">Visibility</a>

<a id="185" class="Keyword">open</a> <a id="190" class="Keyword">import</a> <a id="197" href="PreludeImports.html" class="Module">PreludeImports</a>

<a id="213" class="Keyword">import</a> <a id="220" href="Data.List.NonEmpty.html" class="Module">Data.List.NonEmpty</a> <a id="239" class="Symbol">as</a> <a id="242" class="Module">NE</a>
<a id="245" class="Keyword">open</a> <a id="250" class="Keyword">import</a> <a id="257" href="Data.Maybe.Properties.html" class="Module">Data.Maybe.Properties</a> <a id="279" class="Keyword">using</a> <a id="285" class="Symbol">(</a><a id="286" href="Data.Maybe.Properties.html#947" class="Function">just-injective</a><a id="300" class="Symbol">)</a>
<a id="302" class="Keyword">import</a> <a id="309" href="Data.Nat.Show.html" class="Module">Data.Nat.Show</a> <a id="323" class="Symbol">as</a> <a id="326" class="Module">ℕ</a>

<a id="329" class="Keyword">open</a> <a id="334" class="Keyword">import</a> <a id="341" href="Relation.Nullary.html" class="Module">Relation.Nullary</a>
<a id="358" class="Keyword">open</a> <a id="363" class="Keyword">import</a> <a id="370" href="Relation.Nullary.Negation.html" class="Module">Relation.Nullary.Negation</a>
<a id="396" class="Keyword">open</a> <a id="401" class="Keyword">import</a> <a id="408" href="Relation.Nullary.Decidable.html" class="Module">Relation.Nullary.Decidable</a>

<a id="436" class="Keyword">open</a> <a id="441" class="Keyword">import</a> <a id="448" href="Tactic.ClauseBuilder.html" class="Module">Tactic.ClauseBuilder</a>
<a id="469" class="Keyword">open</a> <a id="474" class="Keyword">import</a> <a id="481" href="Tactic.Helpers.html" class="Module">Tactic.Helpers</a>
<a id="496" class="Keyword">open</a> <a id="501" class="Keyword">import</a> <a id="508" href="Tactic.ReduceDec.html" class="Module">Tactic.ReduceDec</a>

<a id="526" class="Keyword">open</a> <a id="531" class="Keyword">import</a> <a id="538" href="Interface.ComputationalRelation.html" class="Module">Interface.ComputationalRelation</a>
<a id="570" class="Keyword">open</a> <a id="575" class="Keyword">import</a> <a id="582" href="Interface.DecEq.html" class="Module">Interface.DecEq</a>
<a id="598" class="Keyword">open</a> <a id="603" class="Keyword">import</a> <a id="610" href="Interface.Decidable.Instance.html" class="Module">Interface.Decidable.Instance</a>

<a id="640" class="Keyword">open</a> <a id="645" class="Keyword">import</a> <a id="652" href="Interface.Monad.Instance.html" class="Module">Interface.Monad.Instance</a>
<a id="677" class="Keyword">open</a> <a id="682" class="Keyword">import</a> <a id="689" href="Interface.MonadReader.Instance.html" class="Module">Interface.MonadReader.Instance</a>
<a id="720" class="Keyword">open</a> <a id="725" class="Keyword">import</a> <a id="732" href="Interface.MonadError.Instance.html" class="Module">Interface.MonadError.Instance</a>
<a id="762" class="Keyword">open</a> <a id="767" class="Keyword">import</a> <a id="774" href="Interface.MonadTC.Instance.html" class="Module">Interface.MonadTC.Instance</a>

<a id="802" class="Keyword">instance</a>
  <a id="813" href="Tactic.DeriveComp.html#813" class="Function">_</a> <a id="815" class="Symbol">=</a> <a id="817" href="Tactic.ClauseBuilder.html#10635" class="Function">ContextMonad-MonadTC</a>

<a id="839" class="Keyword">record</a> <a id="STSConstr"></a><a id="846" href="Tactic.DeriveComp.html#846" class="Record">STSConstr</a> <a id="856" class="Symbol">:</a> <a id="858" href="Agda.Primitive.html#320" class="Primitive">Set</a> <a id="862" class="Keyword">where</a>
  <a id="870" class="Keyword">field</a>
    <a id="STSConstr.name"></a><a id="880" href="Tactic.DeriveComp.html#880" class="Field">name</a>    <a id="888" class="Symbol">:</a> <a id="890" href="Agda.Builtin.Reflection.html#471" class="Postulate">Name</a>
    <a id="STSConstr.params"></a><a id="899" href="Tactic.DeriveComp.html#899" class="Field">params</a>  <a id="907" class="Symbol">:</a> <a id="909" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="914" href="Function.Base.html#1994" class="Function Operator">$</a> <a id="916" href="Agda.Builtin.Reflection.html#3926" class="Datatype">Abs</a> <a id="920" href="Function.Base.html#1994" class="Function Operator">$</a> <a id="922" href="Agda.Builtin.Reflection.html#3679" class="Datatype">Arg</a> <a id="926" href="Agda.Builtin.Reflection.html#4741" class="Function">Type</a>
    <a id="STSConstr.clauses"></a><a id="935" href="Tactic.DeriveComp.html#935" class="Field">clauses</a> <a id="943" class="Symbol">:</a> <a id="945" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="950" href="Agda.Builtin.Reflection.html#4741" class="Function">Type</a>
    <a id="STSConstr.context"></a><a id="959" href="Tactic.DeriveComp.html#959" class="Field">context</a> <a id="967" class="Symbol">:</a> <a id="969" href="Agda.Builtin.Reflection.html#4708" class="Datatype">Pattern</a>
    <a id="STSConstr.state"></a><a id="981" href="Tactic.DeriveComp.html#981" class="Field">state</a>   <a id="989" class="Symbol">:</a> <a id="991" href="Agda.Builtin.Reflection.html#4708" class="Datatype">Pattern</a>
    <a id="STSConstr.signal"></a><a id="1003" href="Tactic.DeriveComp.html#1003" class="Field">signal</a>  <a id="1011" class="Symbol">:</a> <a id="1013" href="Agda.Builtin.Reflection.html#4708" class="Datatype">Pattern</a>
    <a id="STSConstr.result"></a><a id="1025" href="Tactic.DeriveComp.html#1025" class="Field">result</a>  <a id="1033" class="Symbol">:</a> <a id="1035" href="Agda.Builtin.Reflection.html#4670" class="Datatype">Term</a>

<a id="conOrVarToPattern"></a><a id="1041" href="Tactic.DeriveComp.html#1041" class="Function">conOrVarToPattern</a> <a id="1059" class="Symbol">:</a> <a id="1061" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a> <a id="1063" class="Symbol">→</a> <a id="1065" href="Agda.Builtin.Reflection.html#4670" class="Datatype">Term</a> <a id="1070" class="Symbol">→</a> <a id="1072" href="Agda.Builtin.Maybe.html#118" class="Datatype">Maybe</a> <a id="1078" href="Agda.Builtin.Reflection.html#4708" class="Datatype">Pattern</a>
<a id="1086" href="Tactic.DeriveComp.html#1041" class="Function">conOrVarToPattern</a> <a id="1104" href="Tactic.DeriveComp.html#1104" class="Bound">k</a> <a id="1106" class="Symbol">(</a><a id="1107" href="Generics.Core.html#376" class="InductiveConstructor">♯</a> <a id="1109" href="Tactic.DeriveComp.html#1109" class="Bound">v</a><a id="1110" class="Symbol">)</a> <a id="1112" class="Symbol">=</a> <a id="1114" href="Agda.Builtin.Maybe.html#156" class="InductiveConstructor">just</a> <a id="1119" class="Symbol">(</a><a id="1120" href="Agda.Builtin.Reflection.html#5584" class="InductiveConstructor">Pattern.var</a> <a id="1132" class="Symbol">(</a><a id="1133" href="Tactic.DeriveComp.html#1109" class="Bound">v</a> <a id="1135" href="Data.Nat.Base.html#3202" class="Primitive Operator">∸</a> <a id="1137" href="Tactic.DeriveComp.html#1104" class="Bound">k</a><a id="1138" class="Symbol">))</a>
<a id="1141" href="Tactic.DeriveComp.html#1041" class="Function">conOrVarToPattern</a> <a id="1159" href="Tactic.DeriveComp.html#1159" class="Bound">k</a> <a id="1161" class="Symbol">(</a><a id="1162" href="Agda.Builtin.Reflection.html#4871" class="InductiveConstructor">con</a> <a id="1166" href="Tactic.DeriveComp.html#1166" class="Bound">c</a> <a id="1168" href="Tactic.DeriveComp.html#1168" class="Bound">args</a><a id="1172" class="Symbol">)</a> <a id="1174" class="Symbol">=</a>
  <a id="1178" href="Agda.Builtin.Reflection.html#5491" class="InductiveConstructor">Pattern.con</a> <a id="1190" href="Tactic.DeriveComp.html#1166" class="Bound">c</a> <a id="1192" href="Interface.Monad.html#631" class="Function Operator">&lt;$&gt;</a> <a id="1196" class="Symbol">(</a><a id="1197" href="Interface.Monad.html#975" class="Function">sequenceList</a> <a id="1210" href="Function.Base.html#1994" class="Function Operator">$</a> <a id="1212" href="Tactic.DeriveComp.html#1251" class="Function">conOrVarToPattern′</a> <a id="1231" href="Tactic.DeriveComp.html#1159" class="Bound">k</a> <a id="1233" href="Tactic.DeriveComp.html#1168" class="Bound">args</a><a id="1237" class="Symbol">)</a>
  <a id="1241" class="Keyword">where</a>
    <a id="1251" href="Tactic.DeriveComp.html#1251" class="Function">conOrVarToPattern′</a> <a id="1270" class="Symbol">:</a> <a id="1272" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a> <a id="1274" class="Symbol">→</a> <a id="1276" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="1281" class="Symbol">(</a><a id="1282" href="Agda.Builtin.Reflection.html#3679" class="Datatype">Arg</a> <a id="1286" href="Agda.Builtin.Reflection.html#4670" class="Datatype">Term</a><a id="1290" class="Symbol">)</a> <a id="1292" class="Symbol">→</a> <a id="1294" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="1299" class="Symbol">(</a><a id="1300" href="Agda.Builtin.Maybe.html#118" class="Datatype">Maybe</a> <a id="1306" class="Symbol">(</a><a id="1307" href="Agda.Builtin.Reflection.html#3679" class="Datatype">Arg</a> <a id="1311" href="Agda.Builtin.Reflection.html#4708" class="Datatype">Pattern</a><a id="1318" class="Symbol">))</a>
    <a id="1325" href="Tactic.DeriveComp.html#1251" class="Function">conOrVarToPattern′</a> <a id="1344" href="Tactic.DeriveComp.html#1344" class="Bound">k</a> <a id="1346" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a> <a id="1349" class="Symbol">=</a> <a id="1351" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a>
    <a id="1358" href="Tactic.DeriveComp.html#1251" class="Function">conOrVarToPattern′</a> <a id="1377" href="Tactic.DeriveComp.html#1377" class="Bound">k</a> <a id="1379" class="Symbol">((</a><a id="1381" href="Agda.Builtin.Reflection.html#3715" class="InductiveConstructor">arg</a> <a id="1385" href="Tactic.DeriveComp.html#1385" class="Bound">i</a> <a id="1387" href="Tactic.DeriveComp.html#1387" class="Bound">x</a><a id="1388" class="Symbol">)</a> <a id="1390" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="1392" href="Tactic.DeriveComp.html#1392" class="Bound">l</a><a id="1393" class="Symbol">)</a> <a id="1395" class="Symbol">=</a> <a id="1397" href="Agda.Builtin.Reflection.html#3715" class="InductiveConstructor">arg</a> <a id="1401" href="Tactic.DeriveComp.html#1385" class="Bound">i</a> <a id="1403" href="Interface.Monad.html#631" class="Function Operator">&lt;$&gt;</a> <a id="1407" href="Tactic.DeriveComp.html#1041" class="Function">conOrVarToPattern</a> <a id="1425" href="Tactic.DeriveComp.html#1377" class="Bound">k</a> <a id="1427" href="Tactic.DeriveComp.html#1387" class="Bound">x</a> <a id="1429" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="1431" href="Tactic.DeriveComp.html#1251" class="Function">conOrVarToPattern′</a> <a id="1450" href="Tactic.DeriveComp.html#1377" class="Bound">k</a> <a id="1452" href="Tactic.DeriveComp.html#1392" class="Bound">l</a>
<a id="1454" href="Tactic.DeriveComp.html#1041" class="CatchallClause Function">conOrVarToPattern</a><a id="1471" class="CatchallClause"> </a><a id="1472" class="CatchallClause Symbol">_</a><a id="1473" class="CatchallClause"> </a><a id="1474" class="CatchallClause Symbol">_</a> <a id="1476" class="Symbol">=</a> <a id="1478" href="Agda.Builtin.Maybe.html#177" class="InductiveConstructor">nothing</a>

<a id="isArg"></a><a id="1487" href="Tactic.DeriveComp.html#1487" class="Function">isArg</a> <a id="1493" class="Symbol">:</a> <a id="1495" class="Symbol">(</a><a id="1496" href="Tactic.DeriveComp.html#1496" class="Bound">a</a> <a id="1498" class="Symbol">:</a> <a id="1500" href="Agda.Builtin.Reflection.html#3926" class="Datatype">Abs</a> <a id="1504" class="Symbol">(</a><a id="1505" href="Agda.Builtin.Reflection.html#3679" class="Datatype">Arg</a> <a id="1509" href="Agda.Builtin.Reflection.html#4670" class="Datatype">Term</a><a id="1513" class="Symbol">))</a> <a id="1516" class="Symbol">→</a> <a id="1518" href="Relation.Nullary.Decidable.Core.html#1476" class="Record">Dec</a> <a id="1522" class="Symbol">_</a>
<a id="1524" href="Tactic.DeriveComp.html#1487" class="Function">isArg</a> <a id="1530" href="Tactic.DeriveComp.html#1530" class="Bound">a</a> <a id="1532" class="Symbol">=</a> <a id="1534" href="Relation.Nullary.Decidable.Core.html#2163" class="Function">¬?</a> <a id="1537" class="Symbol">(</a><a id="1538" href="Generics.Utils.html#1154" class="Function">getVisibility</a> <a id="1552" class="Symbol">(</a><a id="1553" href="Reflection.AST.Abstraction.html#1701" class="Function">unAbs</a> <a id="1559" href="Tactic.DeriveComp.html#1530" class="Bound">a</a><a id="1560" class="Symbol">)</a> <a id="1562" href="Reflection.AST.Argument.Visibility.html#821" class="Function Operator">Visibility.≟</a> <a id="1575" href="Agda.Builtin.Reflection.html#2745" class="InductiveConstructor">visible</a><a id="1582" class="Symbol">)</a>

<a id="toSTSConstr"></a><a id="1585" href="Tactic.DeriveComp.html#1585" class="Function">toSTSConstr</a> <a id="1597" class="Symbol">:</a> <a id="1599" href="Agda.Builtin.Reflection.html#471" class="Postulate">Name</a> <a id="1604" href="Data.Product.Base.html#1109" class="Function Operator">×</a> <a id="1606" href="Generics.Utils.html#2580" class="Function">TypeView</a> <a id="1615" class="Symbol">→</a> <a id="1617" href="Reflection.TCI.html#632" class="Function">TC</a> <a id="1620" href="Tactic.DeriveComp.html#846" class="Record">STSConstr</a>
<a id="1630" href="Tactic.DeriveComp.html#1585" class="Function">toSTSConstr</a> <a id="1642" class="Symbol">(</a><a id="1643" href="Tactic.DeriveComp.html#1643" class="Bound">n</a> <a id="1645" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="1647" class="Symbol">(</a><a id="1648" href="Tactic.DeriveComp.html#1648" class="Bound">cs</a> <a id="1651" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="1653" href="Agda.Builtin.Reflection.html#4928" class="InductiveConstructor">def</a> <a id="1657" class="Symbol">_</a> <a id="1659" href="Tactic.DeriveComp.html#1659" class="Bound">args</a><a id="1663" class="Symbol">))</a> <a id="1666" class="Keyword">with</a> <a id="1671" href="Tactic.DeriveComp.html#1659" class="Bound">args</a> <a id="1676" class="Symbol">|</a> <a id="1678" href="Data.List.Base.html#1691" class="Function">mapMaybe</a> <a id="1687" class="Symbol">(</a><a id="1688" href="Tactic.DeriveComp.html#1041" class="Function">conOrVarToPattern</a> <a id="1706" class="Symbol">(</a><a id="1707" href="Data.List.Base.html#5058" class="Function">length</a> <a id="1714" href="Function.Base.html#1994" class="Function Operator">$</a> <a id="1716" href="Data.List.Base.html#11303" class="Function">dropWhile</a> <a id="1726" href="Tactic.DeriveComp.html#1487" class="Function">isArg</a> <a id="1732" href="Tactic.DeriveComp.html#1648" class="Bound">cs</a><a id="1734" class="Symbol">)</a> <a id="1736" href="Function.Base.html#1106" class="Function Operator">∘</a> <a id="1738" href="Reflection.AST.Argument.html#2624" class="Function">unArg</a><a id="1743" class="Symbol">)</a> <a id="1745" href="Function.Base.html#1994" class="Function Operator">$</a> <a id="1747" href="Data.List.Base.html#8449" class="Function">take</a> <a id="1752" class="Number">3</a> <a id="1754" href="Tactic.DeriveComp.html#1659" class="Bound">args</a>
<a id="1759" class="Symbol">...</a> <a id="1763" class="Symbol">|</a> <a id="1765" class="Symbol">_</a> <a id="1767" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="1769" class="Symbol">_</a> <a id="1771" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="1773" class="Symbol">_</a> <a id="1775" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="1777" href="Tactic.DeriveComp.html#1777" class="Bound">r</a> <a id="1779" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="1781" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a> <a id="1784" class="Symbol">|</a> <a id="1786" href="Tactic.DeriveComp.html#1786" class="Bound">c</a> <a id="1788" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="1790" href="Tactic.DeriveComp.html#1790" class="Bound">s</a> <a id="1792" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="1794" href="Tactic.DeriveComp.html#1794" class="Bound">sig</a> <a id="1798" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="1800" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a> <a id="1803" class="Symbol">=</a>
  <a id="1807" href="Interface.Monad.html#290" class="Field">return</a> <a id="1814" class="Keyword">record</a>
    <a id="1825" class="Symbol">{</a> <a id="1827" href="Tactic.DeriveComp.html#880" class="Field">name</a> <a id="1832" class="Symbol">=</a> <a id="1834" class="Bound">n</a>
    <a id="1840" class="Symbol">;</a> <a id="1842" href="Tactic.DeriveComp.html#899" class="Field">params</a> <a id="1849" class="Symbol">=</a> <a id="1851" href="Data.List.Base.html#11203" class="Function">takeWhile</a> <a id="1861" href="Tactic.DeriveComp.html#1487" class="Function">isArg</a> <a id="1867" class="Bound">cs</a>
    <a id="1874" class="Symbol">;</a> <a id="1876" href="Tactic.DeriveComp.html#935" class="Field">clauses</a> <a id="1884" class="Symbol">=</a> <a id="1886" href="Tactic.Helpers.html#640" class="Function">zipWithIndex</a> <a id="1899" class="Symbol">(λ</a> <a id="1902" href="Tactic.DeriveComp.html#1902" class="Bound">i</a> <a id="1904" class="Symbol">→</a> <a id="1906" href="Generics.Utils.html#5759" class="Function">mapVars</a> <a id="1914" class="Symbol">(</a><a id="1915" href="Data.Nat.Base.html#3202" class="Primitive Operator">_∸</a> <a id="1918" href="Tactic.DeriveComp.html#1902" class="Bound">i</a><a id="1919" class="Symbol">))</a> <a id="1922" href="Function.Base.html#1994" class="Function Operator">$</a> <a id="1924" class="Symbol">(</a><a id="1925" href="Reflection.AST.Argument.html#2624" class="Function">unArg</a> <a id="1931" href="Function.Base.html#1106" class="Function Operator">∘</a> <a id="1933" href="Reflection.AST.Abstraction.html#1701" class="Function">unAbs</a><a id="1938" class="Symbol">)</a> <a id="1940" href="Interface.Monad.html#631" class="Function Operator">&lt;$&gt;</a> <a id="1944" href="Data.List.Base.html#11303" class="Function">dropWhile</a> <a id="1954" href="Tactic.DeriveComp.html#1487" class="Function">isArg</a> <a id="1960" class="Bound">cs</a>
    <a id="1967" class="Symbol">;</a> <a id="1969" href="Tactic.DeriveComp.html#959" class="Field">context</a> <a id="1977" class="Symbol">=</a> <a id="1979" href="Tactic.DeriveComp.html#1786" class="Bound">c</a>
    <a id="1985" class="Symbol">;</a> <a id="1987" href="Tactic.DeriveComp.html#981" class="Field">state</a> <a id="1993" class="Symbol">=</a> <a id="1995" href="Tactic.DeriveComp.html#1790" class="Bound">s</a>
    <a id="2001" class="Symbol">;</a> <a id="2003" href="Tactic.DeriveComp.html#1003" class="Field">signal</a> <a id="2010" class="Symbol">=</a> <a id="2012" href="Tactic.DeriveComp.html#1794" class="Bound">sig</a>
    <a id="2020" class="Symbol">;</a> <a id="2022" href="Tactic.DeriveComp.html#1025" class="Field">result</a> <a id="2029" class="Symbol">=</a> <a id="2031" href="Generics.Utils.html#5759" class="Function">mapVars</a> <a id="2039" class="Symbol">(</a><a id="2040" href="Data.Nat.Base.html#3202" class="Primitive Operator">_∸</a> <a id="2043" class="Symbol">(</a><a id="2044" href="Data.List.Base.html#5058" class="Function">length</a> <a id="2051" href="Function.Base.html#1994" class="Function Operator">$</a> <a id="2053" href="Data.List.Base.html#11303" class="Function">dropWhile</a> <a id="2063" href="Tactic.DeriveComp.html#1487" class="Function">isArg</a> <a id="2069" class="Bound">cs</a><a id="2071" class="Symbol">))</a> <a id="2074" href="Function.Base.html#1994" class="Function Operator">$</a> <a id="2076" href="Reflection.AST.Argument.html#2624" class="Function">unArg</a> <a id="2082" href="Tactic.DeriveComp.html#1777" class="Bound">r</a> <a id="2084" class="Symbol">}</a>
<a id="2086" class="CatchallClause Symbol">...</a><a id="2089" class="CatchallClause"> </a><a id="2090" class="CatchallClause Symbol">|</a><a id="2091" class="CatchallClause"> </a><a id="2092" href="Tactic.DeriveComp.html#2092" class="CatchallClause Bound">l</a><a id="2093" class="CatchallClause"> </a><a id="2094" class="CatchallClause Symbol">|</a><a id="2095" class="CatchallClause"> </a><a id="2096" href="Tactic.DeriveComp.html#2096" class="CatchallClause Bound">l&#39;</a> <a id="2099" class="Symbol">=</a>
  <a id="2103" href="Interface.MonadTC.html#8551" class="Function">error1</a> <a id="2110" class="Symbol">(</a><a id="2111" class="String">&quot;toSTSConstr: wrong number of arguments:&quot;</a> <a id="2153" href="Data.String.Base.html#3047" class="Function Operator">&lt;+&gt;</a> <a id="2157" href="Data.Nat.Show.html#1924" class="Function">ℕ.show</a> <a id="2164" class="Symbol">(</a><a id="2165" href="Data.List.Base.html#5058" class="Function">length</a> <a id="2172" href="Tactic.DeriveComp.html#2092" class="Bound">l</a><a id="2173" class="Symbol">)</a> <a id="2175" href="Data.String.Base.html#3047" class="Function Operator">&lt;+&gt;</a> <a id="2179" class="String">&quot;,&quot;</a> <a id="2183" href="Data.String.Base.html#3047" class="Function Operator">&lt;+&gt;</a> <a id="2187" href="Data.Nat.Show.html#1924" class="Function">ℕ.show</a> <a id="2194" class="Symbol">(</a><a id="2195" href="Data.List.Base.html#5058" class="Function">length</a> <a id="2202" href="Tactic.DeriveComp.html#2096" class="Bound">l&#39;</a><a id="2204" class="Symbol">))</a>
<a id="2207" href="Tactic.DeriveComp.html#1585" class="CatchallClause Function">toSTSConstr</a><a id="2218" class="CatchallClause"> </a><a id="2219" class="CatchallClause Symbol">_</a> <a id="2221" class="Symbol">=</a> <a id="2223" href="Interface.MonadTC.html#8551" class="Function">error1</a> <a id="2230" class="String">&quot;toSTSConstr: wrong constructor&quot;</a>

<a id="errorIfNothing"></a><a id="2264" href="Tactic.DeriveComp.html#2264" class="Function">errorIfNothing</a> <a id="2279" class="Symbol">:</a> <a id="2281" class="Symbol">∀</a> <a id="2283" class="Symbol">{</a><a id="2284" href="Tactic.DeriveComp.html#2284" class="Bound">a</a><a id="2285" class="Symbol">}</a> <a id="2287" class="Symbol">{</a><a id="2288" href="Tactic.DeriveComp.html#2288" class="Bound">A</a> <a id="2290" class="Symbol">:</a> <a id="2292" href="Agda.Primitive.html#320" class="Primitive">Set</a> <a id="2296" href="Tactic.DeriveComp.html#2284" class="Bound">a</a><a id="2297" class="Symbol">}</a> <a id="2299" class="Symbol">→</a> <a id="2301" href="Agda.Builtin.Maybe.html#118" class="Datatype">Maybe</a> <a id="2307" href="Tactic.DeriveComp.html#2288" class="Bound">A</a> <a id="2309" class="Symbol">→</a> <a id="2311" href="Agda.Builtin.String.html#318" class="Postulate">String</a> <a id="2318" class="Symbol">→</a> <a id="2320" href="Reflection.TCI.html#632" class="Function">TC</a> <a id="2323" href="Tactic.DeriveComp.html#2288" class="Bound">A</a>
<a id="2325" href="Tactic.DeriveComp.html#2264" class="Function">errorIfNothing</a> <a id="2340" class="Symbol">(</a><a id="2341" href="Agda.Builtin.Maybe.html#156" class="InductiveConstructor">just</a> <a id="2346" href="Tactic.DeriveComp.html#2346" class="Bound">x</a><a id="2347" class="Symbol">)</a> <a id="2349" href="Tactic.DeriveComp.html#2349" class="Bound">s</a> <a id="2351" class="Symbol">=</a> <a id="2353" href="Interface.Monad.html#290" class="Field">return</a> <a id="2360" href="Tactic.DeriveComp.html#2346" class="Bound">x</a>
<a id="2362" href="Tactic.DeriveComp.html#2264" class="Function">errorIfNothing</a> <a id="2377" href="Agda.Builtin.Maybe.html#177" class="InductiveConstructor">nothing</a> <a id="2385" href="Tactic.DeriveComp.html#2385" class="Bound">s</a> <a id="2387" class="Symbol">=</a> <a id="2389" href="Interface.MonadTC.html#8551" class="Function">error1</a> <a id="2396" href="Tactic.DeriveComp.html#2385" class="Bound">s</a>

<a id="getSTSConstrs"></a><a id="2399" href="Tactic.DeriveComp.html#2399" class="Function">getSTSConstrs</a> <a id="2413" class="Symbol">:</a> <a id="2415" href="Agda.Builtin.Reflection.html#471" class="Postulate">Name</a> <a id="2420" class="Symbol">→</a> <a id="2422" href="Reflection.TCI.html#632" class="Function">TC</a> <a id="2425" class="Symbol">(</a><a id="2426" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="2431" href="Tactic.DeriveComp.html#846" class="Record">STSConstr</a><a id="2440" class="Symbol">)</a>
<a id="2442" href="Tactic.DeriveComp.html#2399" class="Function">getSTSConstrs</a> <a id="2456" href="Tactic.DeriveComp.html#2456" class="Bound">n</a> <a id="2458" class="Symbol">=</a> <a id="2460" href="Tactic.Helpers.html#2528" class="Function">inDebugPath</a> <a id="2472" class="String">&quot;getSTSConstrs&quot;</a> <a id="2488" class="Keyword">do</a>
  <a id="2493" href="Tactic.DeriveComp.html#2493" class="Bound">dataDef</a> <a id="2501" href="Interface.Monad.html#311" class="Field Operator">←</a> <a id="2503" href="Tactic.Helpers.html#3182" class="Function">getDataDef</a> <a id="2514" href="Tactic.DeriveComp.html#2456" class="Bound">n</a>
  <a id="2518" href="Tactic.DeriveComp.html#2518" class="Bound">res</a> <a id="2522" href="Interface.Monad.html#311" class="Field Operator">←</a> <a id="2524" href="Interface.Monad.html#824" class="Function">traverseList</a> <a id="2537" href="Tactic.DeriveComp.html#1585" class="Function">toSTSConstr</a> <a id="2549" class="Symbol">(</a><a id="2550" href="Tactic.Helpers.html#790" class="Field">DataDef.constructors</a> <a id="2571" href="Tactic.DeriveComp.html#2493" class="Bound">dataDef</a><a id="2578" class="Symbol">)</a>
  <a id="2582" href="Interface.MonadTC.html#5865" class="Function">debugLogᵐ</a> <a id="2592" class="Symbol">(</a><a id="2593" href="Tactic.DeriveComp.html#2518" class="Bound">res</a> <a id="2597" href="Interface.MonadTC.html#5351" class="Function Operator">ᵛⁿ</a> <a id="2600" href="Interface.MonadTC.html#5134" class="Function Operator">∷ᵈᵐ</a> <a id="2604" href="Interface.MonadTC.html#5071" class="Function">[]ᵐ</a><a id="2607" class="Symbol">)</a>
  <a id="2611" href="Interface.Monad.html#290" class="Field">return</a> <a id="2618" href="Tactic.DeriveComp.html#2518" class="Bound">res</a>

<a id="generatePred"></a><a id="2623" href="Tactic.DeriveComp.html#2623" class="Function">generatePred</a> <a id="2636" class="Symbol">:</a> <a id="2638" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="2643" href="Agda.Builtin.Reflection.html#4670" class="Datatype">Term</a> <a id="2648" class="Symbol">→</a> <a id="2650" href="Agda.Builtin.Reflection.html#4670" class="Datatype">Term</a>
<a id="2655" href="Tactic.DeriveComp.html#2623" class="Function">generatePred</a> <a id="2668" href="Tactic.DeriveComp.html#2668" class="Bound">clauses</a> <a id="2676" class="Symbol">=</a> <a id="2678" class="Keyword">quote</a> <a id="2684" href="Interface.Decidable.Instance.html#583" class="Function Operator">¿_¿</a> <a id="2688" href="Generics.Core.html#1847" class="InductiveConstructor Operator">∙⟦</a> <a id="2691" href="Tactic.DeriveComp.html#2720" class="Function">helper</a> <a id="2698" href="Tactic.DeriveComp.html#2668" class="Bound">clauses</a> <a id="2706" href="Generics.Core.html#1847" class="InductiveConstructor Operator">⟧</a>
  <a id="2710" class="Keyword">where</a>
    <a id="2720" href="Tactic.DeriveComp.html#2720" class="Function">helper</a> <a id="2727" class="Symbol">:</a> <a id="2729" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="2734" href="Agda.Builtin.Reflection.html#4670" class="Datatype">Term</a> <a id="2739" class="Symbol">→</a> <a id="2741" href="Agda.Builtin.Reflection.html#4670" class="Datatype">Term</a>
    <a id="2750" href="Tactic.DeriveComp.html#2720" class="Function">helper</a> <a id="2757" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a> <a id="2760" class="Symbol">=</a> <a id="2762" class="Keyword">quoteTerm</a> <a id="2772" href="Agda.Builtin.Unit.html#158" class="Record">⊤</a>
    <a id="2778" href="Tactic.DeriveComp.html#2720" class="Function">helper</a> <a id="2785" class="Symbol">(</a><a id="2786" href="Tactic.DeriveComp.html#2786" class="Bound">x</a> <a id="2788" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="2790" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a><a id="2792" class="Symbol">)</a> <a id="2794" class="Symbol">=</a> <a id="2796" href="Tactic.DeriveComp.html#2786" class="Bound">x</a>
    <a id="2802" href="Tactic.DeriveComp.html#2720" class="Function">helper</a> <a id="2809" class="Symbol">(</a><a id="2810" href="Tactic.DeriveComp.html#2810" class="Bound">x</a> <a id="2812" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="2814" href="Tactic.DeriveComp.html#2814" class="Bound">x₁</a> <a id="2817" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="2819" href="Tactic.DeriveComp.html#2819" class="Bound">l</a><a id="2820" class="Symbol">)</a> <a id="2822" class="Symbol">=</a> <a id="2824" class="Keyword">quote</a> <a id="2830" href="Data.Product.Base.html#1109" class="Function Operator">_×_</a> <a id="2834" href="Generics.Core.html#1887" class="InductiveConstructor Operator">∙⟦</a> <a id="2837" href="Tactic.DeriveComp.html#2810" class="Bound">x</a> <a id="2839" href="Generics.Core.html#1887" class="InductiveConstructor Operator">∣</a> <a id="2841" href="Tactic.DeriveComp.html#2720" class="Function">helper</a> <a id="2848" class="Symbol">(</a><a id="2849" href="Tactic.DeriveComp.html#2814" class="Bound">x₁</a> <a id="2852" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="2854" href="Tactic.DeriveComp.html#2819" class="Bound">l</a><a id="2855" class="Symbol">)</a> <a id="2857" href="Generics.Core.html#1887" class="InductiveConstructor Operator">⟧</a>

<a id="curryPredProof"></a><a id="2860" href="Tactic.DeriveComp.html#2860" class="Function">curryPredProof</a> <a id="2875" class="Symbol">:</a> <a id="2877" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a> <a id="2879" class="Symbol">→</a> <a id="2881" href="Agda.Builtin.Reflection.html#4670" class="Datatype">Term</a> <a id="2886" class="Symbol">→</a> <a id="2888" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="2893" class="Symbol">(</a><a id="2894" href="Agda.Builtin.Reflection.html#3679" class="Datatype">Arg</a> <a id="2898" href="Agda.Builtin.Reflection.html#4670" class="Datatype">Term</a><a id="2902" class="Symbol">)</a>
<a id="2904" href="Tactic.DeriveComp.html#2860" class="Function">curryPredProof</a> <a id="2919" class="Number">0</a> <a id="2921" href="Tactic.DeriveComp.html#2921" class="Bound">t</a> <a id="2923" class="Symbol">=</a> <a id="2925" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a>
<a id="2928" href="Tactic.DeriveComp.html#2860" class="Function">curryPredProof</a> <a id="2943" class="Number">1</a> <a id="2945" href="Tactic.DeriveComp.html#2945" class="Bound">t</a> <a id="2947" class="Symbol">=</a> <a id="2949" href="Data.List.Base.html#5219" class="Function Operator">[</a> <a id="2951" href="Reflection.AST.Argument.html#1295" class="InductiveConstructor">vArg</a> <a id="2956" href="Tactic.DeriveComp.html#2945" class="Bound">t</a> <a id="2958" href="Data.List.Base.html#5219" class="Function Operator">]</a>
<a id="2960" href="Tactic.DeriveComp.html#2860" class="Function">curryPredProof</a> <a id="2975" class="Number">2</a> <a id="2977" href="Tactic.DeriveComp.html#2977" class="Bound">t</a> <a id="2979" class="Symbol">=</a> <a id="2981" class="Keyword">quote</a> <a id="2987" href="Data.Product.Base.html#608" class="Field">proj₁</a> <a id="2993" href="Generics.Core.html#1847" class="InductiveConstructor Operator">∙⟦</a> <a id="2996" href="Tactic.DeriveComp.html#2977" class="Bound">t</a> <a id="2998" href="Generics.Core.html#1847" class="InductiveConstructor Operator">⟧</a> <a id="3000" href="Reflection.AST.Argument.html#1687" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="3004" class="Keyword">quote</a> <a id="3010" href="Data.Product.Base.html#622" class="Field">proj₂</a> <a id="3016" href="Generics.Core.html#1847" class="InductiveConstructor Operator">∙⟦</a> <a id="3019" href="Tactic.DeriveComp.html#2977" class="Bound">t</a> <a id="3021" href="Generics.Core.html#1847" class="InductiveConstructor Operator">⟧</a> <a id="3023" href="Reflection.AST.Argument.html#1687" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="3027" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a>
<a id="3030" href="Tactic.DeriveComp.html#2860" class="Function">curryPredProof</a> <a id="3045" class="Symbol">(</a><a id="3046" href="Agda.Builtin.Nat.html#217" class="InductiveConstructor">suc</a> <a id="3050" class="Symbol">(</a><a id="3051" href="Agda.Builtin.Nat.html#217" class="InductiveConstructor">suc</a> <a id="3055" class="Symbol">(</a><a id="3056" href="Agda.Builtin.Nat.html#217" class="InductiveConstructor">suc</a> <a id="3060" href="Tactic.DeriveComp.html#3060" class="Bound">k</a><a id="3061" class="Symbol">)))</a> <a id="3065" href="Tactic.DeriveComp.html#3065" class="Bound">t</a> <a id="3067" class="Symbol">=</a> <a id="3069" class="Keyword">quote</a> <a id="3075" href="Data.Product.Base.html#608" class="Field">proj₁</a> <a id="3081" href="Generics.Core.html#1847" class="InductiveConstructor Operator">∙⟦</a> <a id="3084" href="Tactic.DeriveComp.html#3065" class="Bound">t</a> <a id="3086" href="Generics.Core.html#1847" class="InductiveConstructor Operator">⟧</a> <a id="3088" href="Reflection.AST.Argument.html#1687" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="3092" href="Tactic.DeriveComp.html#2860" class="Function">curryPredProof</a> <a id="3107" class="Symbol">(</a><a id="3108" href="Agda.Builtin.Nat.html#217" class="InductiveConstructor">suc</a> <a id="3112" class="Symbol">(</a><a id="3113" href="Agda.Builtin.Nat.html#217" class="InductiveConstructor">suc</a> <a id="3117" href="Tactic.DeriveComp.html#3060" class="Bound">k</a><a id="3118" class="Symbol">))</a> <a id="3121" class="Symbol">(</a><a id="3122" class="Keyword">quote</a> <a id="3128" href="Data.Product.Base.html#622" class="Field">proj₂</a> <a id="3134" href="Generics.Core.html#1847" class="InductiveConstructor Operator">∙⟦</a> <a id="3137" href="Tactic.DeriveComp.html#3065" class="Bound">t</a> <a id="3139" href="Generics.Core.html#1847" class="InductiveConstructor Operator">⟧</a><a id="3140" class="Symbol">)</a>

<a id="generateFunctionClause"></a><a id="3143" href="Tactic.DeriveComp.html#3143" class="Function">generateFunctionClause</a> <a id="3166" class="Symbol">:</a> <a id="3168" class="Symbol">(</a><a id="3169" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="3174" href="Agda.Builtin.Reflection.html#4670" class="Datatype">Term</a> <a id="3179" class="Symbol">→</a> <a id="3181" href="Agda.Builtin.Reflection.html#4670" class="Datatype">Term</a><a id="3185" class="Symbol">)</a> <a id="3187" class="Symbol">→</a> <a id="3189" href="Tactic.DeriveComp.html#846" class="Record">STSConstr</a> <a id="3199" class="Symbol">→</a> <a id="3201" href="Agda.Builtin.Reflection.html#4727" class="Datatype">Clause</a>
<a id="3208" href="Tactic.DeriveComp.html#3143" class="Function">generateFunctionClause</a> <a id="3231" href="Tactic.DeriveComp.html#3231" class="Bound">genPred</a> <a id="3239" href="Tactic.DeriveComp.html#3239" class="Bound">c</a> <a id="3241" class="Symbol">=</a> <a id="3243" class="Keyword">let</a> <a id="3247" class="Keyword">open</a> <a id="3252" href="Tactic.DeriveComp.html#846" class="Module">STSConstr</a> <a id="3262" href="Tactic.DeriveComp.html#3239" class="Bound">c</a> <a id="3264" class="Keyword">in</a>
  <a id="3269" href="Generics.Core.html#1059" class="InductiveConstructor Operator">⟦</a> <a id="3271" href="Tactic.DeriveComp.html#959" class="Field">context</a> <a id="3279" href="Generics.Core.html#1059" class="InductiveConstructor Operator">∣</a> <a id="3281" href="Tactic.DeriveComp.html#981" class="Field">state</a> <a id="3287" href="Generics.Core.html#1059" class="InductiveConstructor Operator">∣</a> <a id="3289" href="Tactic.DeriveComp.html#1003" class="Field">signal</a> <a id="3296" href="Generics.Core.html#1059" class="InductiveConstructor Operator">⦅</a> <a id="3298" class="Symbol">(λ</a> <a id="3301" class="Symbol">{</a> <a id="3303" class="Symbol">(</a><a id="3304" href="Agda.Builtin.Reflection.html#3962" class="InductiveConstructor">abs</a> <a id="3308" href="Tactic.DeriveComp.html#3308" class="Bound">s</a> <a id="3310" href="Tactic.DeriveComp.html#3310" class="Bound">x</a><a id="3311" class="Symbol">)</a> <a id="3313" class="Symbol">→</a> <a id="3315" class="Symbol">(</a><a id="3316" href="Tactic.DeriveComp.html#3308" class="Bound">s</a> <a id="3318" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="3320" href="Tactic.DeriveComp.html#3310" class="Bound">x</a><a id="3321" class="Symbol">)</a> <a id="3323" class="Symbol">})</a> <a id="3326" href="Interface.Monad.html#631" class="Function Operator">&lt;$&gt;</a> <a id="3330" href="Tactic.DeriveComp.html#899" class="Field">params</a> <a id="3337" href="Generics.Core.html#1059" class="InductiveConstructor Operator">⦆⇒</a>
    <a id="3344" class="Keyword">quote</a> <a id="3350" href="Data.Bool.Base.html#1283" class="Function Operator">if_then_else_</a> <a id="3364" href="Generics.Core.html#1940" class="InductiveConstructor Operator">∙⟦</a> <a id="3367" class="Keyword">quote</a> <a id="3373" href="Relation.Nullary.Decidable.Core.html#3274" class="Function Operator">⌊_⌋</a> <a id="3377" href="Generics.Core.html#1847" class="InductiveConstructor Operator">∙⟦</a> <a id="3380" href="Tactic.DeriveComp.html#3231" class="Bound">genPred</a> <a id="3388" href="Tactic.DeriveComp.html#935" class="Field">clauses</a> <a id="3396" href="Generics.Core.html#1847" class="InductiveConstructor Operator">⟧</a> <a id="3398" href="Generics.Core.html#1940" class="InductiveConstructor Operator">∣</a>
      <a id="3406" class="Keyword">quote</a> <a id="3412" href="Agda.Builtin.Maybe.html#156" class="InductiveConstructor">just</a> <a id="3417" href="Generics.Core.html#2110" class="InductiveConstructor Operator">◆⟦</a> <a id="3420" href="Tactic.DeriveComp.html#1025" class="Field">result</a> <a id="3427" href="Generics.Core.html#2110" class="InductiveConstructor Operator">⟧</a> <a id="3429" href="Generics.Core.html#1940" class="InductiveConstructor Operator">∣</a>
      <a id="3437" class="Keyword">quote</a> <a id="3443" href="Agda.Builtin.Maybe.html#177" class="InductiveConstructor">nothing</a> <a id="3451" href="Generics.Core.html#2086" class="InductiveConstructor Operator">◆</a> <a id="3453" href="Generics.Core.html#1940" class="InductiveConstructor Operator">⟧</a> <a id="3455" href="Generics.Core.html#1059" class="InductiveConstructor Operator">⟧</a>

<a id="generateFunction"></a><a id="3458" href="Tactic.DeriveComp.html#3458" class="Function">generateFunction</a> <a id="3475" class="Symbol">:</a> <a id="3477" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="3482" href="Tactic.DeriveComp.html#846" class="Record">STSConstr</a> <a id="3492" class="Symbol">→</a> <a id="3494" href="Agda.Builtin.Reflection.html#4670" class="Datatype">Term</a>
<a id="3499" href="Tactic.DeriveComp.html#3458" class="Function">generateFunction</a> <a id="3516" href="Tactic.DeriveComp.html#3516" class="Bound">c</a> <a id="3518" class="Symbol">=</a> <a id="3520" href="Agda.Builtin.Reflection.html#5038" class="InductiveConstructor">pat-lam</a> <a id="3528" class="Symbol">(</a><a id="3529" href="Tactic.DeriveComp.html#3143" class="Function">generateFunctionClause</a> <a id="3552" href="Tactic.DeriveComp.html#2623" class="Function">generatePred</a> <a id="3565" href="Interface.Monad.html#631" class="Function Operator">&lt;$&gt;</a> <a id="3569" href="Tactic.DeriveComp.html#3516" class="Bound">c</a><a id="3570" class="Symbol">)</a> <a id="3572" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a>

<a id="rdOpts"></a><a id="3576" href="Tactic.DeriveComp.html#3576" class="Function">rdOpts</a> <a id="3583" class="Symbol">:</a> <a id="3585" href="Interface.MonadTC.html#481" class="Datatype">ReductionOptions</a>
<a id="3602" href="Tactic.DeriveComp.html#3576" class="Function">rdOpts</a> <a id="3609" class="Symbol">=</a> <a id="3611" href="Interface.MonadTC.html#512" class="InductiveConstructor">onlyReduce</a> <a id="3622" href="Data.List.Base.html#5219" class="Function Operator">[</a> <a id="3624" class="Keyword">quote</a> <a id="3630" href="Relation.Nullary.Decidable.Core.html#3274" class="Function Operator">⌊_⌋</a> <a id="3634" href="Data.List.Base.html#5219" class="Function Operator">]</a>

<a id="3637" class="Keyword">open</a> <a id="3642" href="Tactic.ClauseBuilder.html#10865" class="Module">ClauseExprM</a>

<a id="derive⇐"></a><a id="3655" href="Tactic.DeriveComp.html#3655" class="Function">derive⇐</a> <a id="3663" class="Symbol">:</a> <a id="3665" href="Tactic.Helpers.html#5653" class="Function">ITactic</a>
<a id="3673" href="Tactic.DeriveComp.html#3655" class="Function">derive⇐</a> <a id="3681" class="Symbol">=</a> <a id="3683" href="Tactic.Helpers.html#2528" class="Function">inDebugPath</a> <a id="3695" class="String">&quot;derive⇐&quot;</a> <a id="3705" class="Keyword">do</a>
  <a id="3710" class="Symbol">(</a><a id="3711" href="Tactic.DeriveComp.html#3711" class="Bound">constrPat</a> <a id="3721" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="3723" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a><a id="3725" class="Symbol">)</a> <a id="3727" href="Interface.Monad.html#311" class="Field Operator">←</a> <a id="3729" href="Tactic.ClauseBuilder.html#8607" class="Function">currentTyConstrPatterns</a>
    <a id="3757" class="Keyword">where</a> <a id="3763" class="CatchallClause Symbol">_</a> <a id="3765" class="Symbol">→</a> <a id="3767" href="Interface.MonadTC.html#8551" class="Function">error1</a> <a id="3774" class="String">&quot;TODO: Support more than one constructor!&quot;</a>
  <a id="3819" href="Tactic.DeriveComp.html#3819" class="Bound">expr</a> <a id="3824" href="Interface.Monad.html#311" class="Field Operator">←</a> <a id="3826" href="Tactic.ClauseBuilder.html#11735" class="Function">singleMatchExpr</a> <a id="3842" href="Tactic.DeriveComp.html#3711" class="Bound">constrPat</a> <a id="3852" href="Function.Base.html#1994" class="Function Operator">$</a> <a id="3854" href="Tactic.ClauseBuilder.html#12783" class="Function">finishMatch</a> <a id="3866" href="Function.Base.html#1994" class="Function Operator">$</a> <a id="3868" href="Interface.MonadTC.html#10808" class="Function">withGoalHole</a> <a id="3881" href="Function.Base.html#1994" class="Function Operator">$</a> <a id="3883" href="Tactic.ReduceDec.html#4941" class="Function">reduceDecInGoal</a> <a id="3899" href="Tactic.DeriveComp.html#3576" class="Function">rdOpts</a> <a id="3906" class="Symbol">(</a><a id="3907" class="Keyword">quote</a> <a id="3913" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a> <a id="3918" href="Generics.Core.html#2086" class="InductiveConstructor Operator">◆</a><a id="3919" class="Symbol">)</a>
  <a id="3923" href="Interface.MonadTC.html#10332" class="Function">unifyWithGoal</a> <a id="3937" href="Function.Base.html#1994" class="Function Operator">$</a> <a id="3939" href="Tactic.ClauseBuilder.html#7490" class="Function">clauseExprToPatLam</a> <a id="3958" href="Tactic.DeriveComp.html#3819" class="Bound">expr</a>

<a id="derive⇒"></a><a id="3964" href="Tactic.DeriveComp.html#3964" class="Function">derive⇒</a> <a id="3972" class="Symbol">:</a> <a id="3974" href="Agda.Builtin.Reflection.html#471" class="Postulate">Name</a> <a id="3979" class="Symbol">→</a> <a id="3981" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="3986" href="Tactic.DeriveComp.html#846" class="Record">STSConstr</a> <a id="3996" class="Symbol">→</a> <a id="3998" href="Tactic.Helpers.html#5653" class="Function">ITactic</a>
<a id="4006" href="Tactic.DeriveComp.html#3964" class="Function">derive⇒</a> <a id="4014" href="Tactic.DeriveComp.html#4014" class="Bound">n</a> <a id="4016" class="Symbol">(</a><a id="4017" class="Keyword">record</a> <a id="4024" class="Symbol">{</a> <a id="4026" href="Tactic.DeriveComp.html#880" class="Field">name</a> <a id="4031" class="Symbol">=</a> <a id="4033" href="Tactic.DeriveComp.html#4033" class="Bound">stsConstrName</a> <a id="4047" class="Symbol">;</a> <a id="4049" href="Tactic.DeriveComp.html#935" class="Field">clauses</a> <a id="4057" class="Symbol">=</a> <a id="4059" href="Tactic.DeriveComp.html#4059" class="Bound">clauses</a> <a id="4067" class="Symbol">}</a> <a id="4069" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="4071" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a><a id="4073" class="Symbol">)</a> <a id="4075" class="Symbol">=</a> <a id="4077" href="Tactic.Helpers.html#2528" class="Function">inDebugPath</a> <a id="4089" class="String">&quot;derive⇒&quot;</a> <a id="4099" class="Keyword">do</a>
  <a id="4104" href="Tactic.DeriveComp.html#4104" class="Bound">expr</a> <a id="4109" href="Interface.Monad.html#311" class="Field Operator">←</a> <a id="4111" href="Tactic.ClauseBuilder.html#12363" class="Function">introsExpr</a> <a id="4122" class="Symbol">(</a><a id="4123" href="Data.Maybe.Base.html#1921" class="Function">from-just</a> <a id="4133" href="Function.Base.html#1994" class="Function Operator">$</a> <a id="4135" href="Data.List.NonEmpty.Base.html#1834" class="Function">NE.fromList</a> <a id="4147" class="Symbol">(</a><a id="4148" class="String">&quot;h&quot;</a> <a id="4152" href="Reflection.AST.Argument.html#1687" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="4156" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a><a id="4158" class="Symbol">))</a> <a id="4161" href="Function.Base.html#1994" class="Function Operator">$</a> <a id="4163" href="Tactic.ClauseBuilder.html#12783" class="Function">finishMatch</a> <a id="4175" href="Function.Base.html#1994" class="Function Operator">$</a>
    <a id="4181" href="Tactic.ClauseBuilder.html#8398" class="Function">caseMatch</a> <a id="4191" class="Symbol">(</a><a id="4192" href="Generics.Utils.html#5759" class="Function">mapVars</a> <a id="4200" class="Symbol">(</a><a id="4201" href="Agda.Builtin.Nat.html#319" class="Primitive Operator">_+</a> <a id="4204" class="Number">2</a><a id="4205" class="Symbol">)</a> <a id="4207" href="Function.Base.html#1994" class="Function Operator">$</a> <a id="4209" href="Tactic.DeriveComp.html#2623" class="Function">generatePred</a> <a id="4222" href="Tactic.DeriveComp.html#4059" class="Bound">clauses</a><a id="4229" class="Symbol">)</a> <a id="4231" href="Function.Base.html#1994" class="Function Operator">$</a> <a id="4233" href="Tactic.ClauseBuilder.html#11023" class="Function">matchExprM</a>
      <a id="4250" class="Symbol">((</a><a id="4252" href="Tactic.ClauseBuilder.html#1479" class="Function">multiSinglePattern</a> <a id="4271" href="Data.List.Base.html#5219" class="Function Operator">[</a> <a id="4273" class="String">&quot;&quot;</a> <a id="4276" href="Data.List.Base.html#5219" class="Function Operator">]</a> <a id="4278" class="Symbol">(</a><a id="4279" href="Reflection.AST.Argument.html#1295" class="InductiveConstructor">vArg</a> <a id="4284" class="Symbol">(</a><a id="4285" href="PreludeImports.html#259" class="InductiveConstructor">``no</a>  <a id="4291" class="Symbol">(</a><a id="4292" href="Generics.Core.html#505" class="InductiveConstructor Operator">`</a> <a id="4294" class="Number">0</a><a id="4295" class="Symbol">)))</a> <a id="4299" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="4301" href="Tactic.ClauseBuilder.html#12783" class="Function">finishMatch</a> <a id="4313" class="Keyword">do</a>
        <a id="4324" href="Tactic.DeriveComp.html#4324" class="Bound">reducedHyp</a> <a id="4335" href="Interface.Monad.html#311" class="Field Operator">←</a> <a id="4337" href="Tactic.ReduceDec.html#4697" class="Function">reduceDec&#39;</a> <a id="4348" href="Tactic.DeriveComp.html#3576" class="Function">rdOpts</a> <a id="4355" href="Function.Base.html#1994" class="Function Operator">$</a> <a id="4357" href="Generics.Core.html#376" class="InductiveConstructor">♯</a> <a id="4359" class="Number">1</a>
        <a id="4369" href="Interface.Monad.html#290" class="Field">return</a> <a id="4376" href="Function.Base.html#1994" class="Function Operator">$</a> <a id="4378" class="Keyword">quote</a> <a id="4384" href="Function.Base.html#4053" class="Function Operator">case_of_</a> <a id="4393" href="Generics.Core.html#1887" class="InductiveConstructor Operator">∙⟦</a> <a id="4396" href="Tactic.DeriveComp.html#4324" class="Bound">reducedHyp</a> <a id="4407" href="Generics.Core.html#1887" class="InductiveConstructor Operator">∣</a> <a id="4409" href="Generics.Core.html#1458" class="InductiveConstructor">`λ∅</a> <a id="4413" href="Generics.Core.html#1887" class="InductiveConstructor Operator">⟧</a><a id="4414" class="Symbol">)</a> <a id="4416" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a>
       <a id="4425" class="Symbol">(</a><a id="4426" href="Tactic.ClauseBuilder.html#1479" class="Function">multiSinglePattern</a> <a id="4445" href="Data.List.Base.html#5219" class="Function Operator">[</a> <a id="4447" class="String">&quot;&quot;</a> <a id="4450" href="Data.List.Base.html#5219" class="Function Operator">]</a> <a id="4452" class="Symbol">(</a><a id="4453" href="Reflection.AST.Argument.html#1295" class="InductiveConstructor">vArg</a> <a id="4458" class="Symbol">(</a><a id="4459" href="PreludeImports.html#187" class="InductiveConstructor">``yes</a> <a id="4465" class="Symbol">(</a><a id="4466" href="Generics.Core.html#505" class="InductiveConstructor Operator">`</a> <a id="4468" class="Number">0</a><a id="4469" class="Symbol">)))</a> <a id="4473" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="4475" href="Tactic.ClauseBuilder.html#12783" class="Function">finishMatch</a> <a id="4487" class="Keyword">do</a>
        <a id="4498" href="Tactic.DeriveComp.html#4498" class="Bound">reducedHyp</a> <a id="4509" href="Interface.Monad.html#311" class="Field Operator">←</a> <a id="4511" href="Tactic.ReduceDec.html#4697" class="Function">reduceDec&#39;</a> <a id="4522" href="Tactic.DeriveComp.html#3576" class="Function">rdOpts</a> <a id="4529" href="Function.Base.html#1994" class="Function Operator">$</a> <a id="4531" href="Generics.Core.html#376" class="InductiveConstructor">♯</a> <a id="4533" class="Number">1</a>
        <a id="4543" href="Tactic.DeriveComp.html#4543" class="Bound">ty</a> <a id="4546" href="Generics.Core.html#2006" class="InductiveConstructor Operator">∙⟦</a> <a id="4549" href="Tactic.DeriveComp.html#4549" class="Bound">c</a> <a id="4551" href="Generics.Core.html#2006" class="InductiveConstructor Operator">∣</a> <a id="4553" href="Tactic.DeriveComp.html#4553" class="Bound">s</a> <a id="4555" href="Generics.Core.html#2006" class="InductiveConstructor Operator">∣</a> <a id="4557" href="Tactic.DeriveComp.html#4557" class="Bound">sig</a> <a id="4561" href="Generics.Core.html#2006" class="InductiveConstructor Operator">∣</a> <a id="4563" href="Tactic.DeriveComp.html#4563" class="Bound">s&#39;</a> <a id="4566" href="Generics.Core.html#2006" class="InductiveConstructor Operator">⟧</a> <a id="4568" href="Interface.Monad.html#311" class="Field Operator">←</a> <a id="4570" href="Interface.MonadTC.html#8930" class="Function">goalTy</a>
          <a id="4587" class="Keyword">where</a> <a id="4593" href="Tactic.DeriveComp.html#4593" class="CatchallClause Bound">ty</a> <a id="4596" class="Symbol">→</a> <a id="4598" href="Interface.MonadError.html#369" class="Field">error</a> <a id="4604" class="Symbol">(</a><a id="4605" class="String">&quot;BUG: Unexpected type&quot;</a> <a id="4628" href="Reflection.Debug.html#996" class="Function Operator">∷ᵈ</a> <a id="4631" href="Tactic.DeriveComp.html#4593" class="Bound">ty</a> <a id="4634" href="Reflection.Debug.html#996" class="Function Operator">∷ᵈ</a> <a id="4637" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a><a id="4639" class="Symbol">)</a>
        <a id="4649" href="Interface.Monad.html#290" class="Field">return</a> <a id="4656" href="Function.Base.html#1994" class="Function Operator">$</a> <a id="4658" class="Keyword">quote</a> <a id="4664" href="Relation.Binary.PropositionalEquality.Core.html#1794" class="Function">subst</a> <a id="4670" href="Generics.Core.html#1940" class="InductiveConstructor Operator">∙⟦</a> <a id="4673" href="Tactic.DeriveComp.html#4543" class="Bound">ty</a> <a id="4676" href="Generics.Core.html#1940" class="InductiveConstructor Operator">∙⟦</a> <a id="4679" href="Tactic.DeriveComp.html#4549" class="Bound">c</a> <a id="4681" href="Generics.Core.html#1940" class="InductiveConstructor Operator">∣</a> <a id="4683" href="Tactic.DeriveComp.html#4553" class="Bound">s</a> <a id="4685" href="Generics.Core.html#1940" class="InductiveConstructor Operator">∣</a> <a id="4687" href="Tactic.DeriveComp.html#4557" class="Bound">sig</a> <a id="4691" href="Generics.Core.html#1940" class="InductiveConstructor Operator">⟧</a> <a id="4693" href="Generics.Core.html#1940" class="InductiveConstructor Operator">∣</a> <a id="4695" class="Keyword">quote</a> <a id="4701" href="Data.Maybe.Properties.html#947" class="Function">just-injective</a> <a id="4716" href="Generics.Core.html#1847" class="InductiveConstructor Operator">∙⟦</a> <a id="4719" href="Tactic.DeriveComp.html#4498" class="Bound">reducedHyp</a> <a id="4730" href="Generics.Core.html#1847" class="InductiveConstructor Operator">⟧</a> <a id="4732" href="Generics.Core.html#1940" class="InductiveConstructor Operator">∣</a>
                             <a id="4763" href="Agda.Builtin.Reflection.html#4871" class="InductiveConstructor">con</a> <a id="4767" href="Tactic.DeriveComp.html#4033" class="Bound">stsConstrName</a> <a id="4781" class="Symbol">(</a><a id="4782" href="Tactic.DeriveComp.html#2860" class="Function">curryPredProof</a> <a id="4797" class="Symbol">(</a><a id="4798" href="Data.List.Base.html#5058" class="Function">length</a> <a id="4805" href="Tactic.DeriveComp.html#4059" class="Bound">clauses</a><a id="4812" class="Symbol">)</a> <a id="4814" class="Symbol">(</a><a id="4815" href="Generics.Core.html#376" class="InductiveConstructor">♯</a> <a id="4817" class="Number">0</a><a id="4818" class="Symbol">))</a> <a id="4821" href="Generics.Core.html#1940" class="InductiveConstructor Operator">⟧</a><a id="4822" class="Symbol">)</a> <a id="4824" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="4826" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a><a id="4828" class="Symbol">)</a>
  <a id="4832" href="Interface.MonadTC.html#10332" class="Function">unifyWithGoal</a> <a id="4846" href="Function.Base.html#1994" class="Function Operator">$</a> <a id="4848" href="Tactic.ClauseBuilder.html#7490" class="Function">clauseExprToPatLam</a> <a id="4867" href="Tactic.DeriveComp.html#4104" class="Bound">expr</a>
<a id="4872" href="Tactic.DeriveComp.html#3964" class="CatchallClause Function">derive⇒</a><a id="4879" class="CatchallClause"> </a><a id="4880" class="CatchallClause Symbol">_</a><a id="4881" class="CatchallClause"> </a><a id="4882" class="CatchallClause Symbol">_</a> <a id="4884" class="Symbol">=</a> <a id="4886" href="Interface.MonadTC.html#8551" class="Function">error1</a> <a id="4893" class="String">&quot;TODO: support multiple constructors&quot;</a>

<a id="4932" class="Keyword">module</a> <a id="4939" href="Tactic.DeriveComp.html#4939" class="Module">_</a> <a id="4941" class="Symbol">⦃</a> <a id="4943" href="Tactic.DeriveComp.html#4943" class="Bound">_</a> <a id="4945" class="Symbol">:</a> <a id="4947" href="Reflection.Debug.html#2344" class="Record">DebugOptions</a> <a id="4960" class="Symbol">⦄</a> <a id="4962" class="Keyword">where</a>
  <a id="4970" href="Tactic.DeriveComp.html#4970" class="Function">derive⇔</a> <a id="4978" class="Symbol">:</a> <a id="4980" href="Agda.Builtin.Reflection.html#471" class="Postulate">Name</a> <a id="4985" class="Symbol">→</a> <a id="4987" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="4992" href="Tactic.DeriveComp.html#846" class="Record">STSConstr</a> <a id="5002" class="Symbol">→</a> <a id="5004" href="Generics.Core.html#2462" class="Function">Tactic</a>
  <a id="5013" href="Tactic.DeriveComp.html#4970" class="Function">derive⇔</a> <a id="5021" href="Tactic.DeriveComp.html#5021" class="Bound">n</a> <a id="5023" href="Tactic.DeriveComp.html#5023" class="Bound">stsConstrs</a> <a id="5034" class="Symbol">=</a> <a id="5036" href="Tactic.Helpers.html#5927" class="Function">initTac</a> <a id="5044" href="Function.Base.html#1994" class="Function Operator">$</a> <a id="5046" href="Tactic.Helpers.html#2528" class="Function">inDebugPath</a> <a id="5058" class="String">&quot;derive⇔&quot;</a> <a id="5068" class="Keyword">do</a>
    <a id="5075" href="Tactic.DeriveComp.html#5075" class="Bound">hole⇒</a> <a id="5081" href="Interface.Monad.html#311" class="Field Operator">←</a> <a id="5083" href="Interface.MonadTC.html#4018" class="Function">newMeta</a> <a id="5091" href="Agda.Builtin.Reflection.html#5271" class="InductiveConstructor">unknown</a>
    <a id="5103" href="Tactic.DeriveComp.html#5103" class="Bound">hole⇐</a> <a id="5109" href="Interface.Monad.html#311" class="Field Operator">←</a> <a id="5111" href="Interface.MonadTC.html#4018" class="Function">newMeta</a> <a id="5119" href="Agda.Builtin.Reflection.html#5271" class="InductiveConstructor">unknown</a>
    <a id="5131" href="Interface.MonadTC.html#10332" class="Function">unifyWithGoal</a> <a id="5145" href="Function.Base.html#1994" class="Function Operator">$</a> <a id="5147" class="Keyword">quote</a> <a id="5153" href="Function.Bundles.html#10043" class="Function">mk⇔</a> <a id="5157" href="Generics.Core.html#1887" class="InductiveConstructor Operator">∙⟦</a> <a id="5160" href="Tactic.DeriveComp.html#5075" class="Bound">hole⇒</a> <a id="5166" href="Generics.Core.html#1887" class="InductiveConstructor Operator">∣</a> <a id="5168" href="Tactic.DeriveComp.html#5103" class="Bound">hole⇐</a> <a id="5174" href="Generics.Core.html#1887" class="InductiveConstructor Operator">⟧</a>
    <a id="5180" href="Interface.MonadTC.html#10492" class="Function">runWithHole</a> <a id="5192" href="Tactic.DeriveComp.html#5103" class="Bound">hole⇐</a> <a id="5198" href="Tactic.DeriveComp.html#3655" class="Function">derive⇐</a>
    <a id="5210" href="Interface.MonadTC.html#10492" class="Function">runWithHole</a> <a id="5222" href="Tactic.DeriveComp.html#5075" class="Bound">hole⇒</a> <a id="5228" href="Function.Base.html#1994" class="Function Operator">$</a> <a id="5230" href="Tactic.DeriveComp.html#3964" class="Function">derive⇒</a> <a id="5238" href="Tactic.DeriveComp.html#5021" class="Bound">n</a> <a id="5240" href="Tactic.DeriveComp.html#5023" class="Bound">stsConstrs</a>

  <a id="5254" href="Tactic.DeriveComp.html#5254" class="Function">deriveComp</a> <a id="5265" class="Symbol">:</a> <a id="5267" href="Agda.Builtin.Reflection.html#471" class="Postulate">Name</a> <a id="5272" class="Symbol">→</a> <a id="5274" href="Reflection.TCI.html#632" class="Function">TC</a> <a id="5277" href="Agda.Builtin.Unit.html#158" class="Record">⊤</a>
  <a id="5281" href="Tactic.DeriveComp.html#5254" class="Function">deriveComp</a> <a id="5292" href="Tactic.DeriveComp.html#5292" class="Bound">definedType</a> <a id="5304" class="Symbol">=</a> <a id="5306" class="Keyword">do</a>
    <a id="5313" href="Interface.MonadTC.html#5576" class="Function">debugLog</a> <a id="5322" class="Symbol">(</a><a id="5323" class="String">&quot;\nDerive computation function for: &quot;</a> <a id="5361" href="Reflection.Debug.html#996" class="Function Operator">∷ᵈ</a> <a id="5364" href="Tactic.DeriveComp.html#5292" class="Bound">definedType</a> <a id="5376" href="Reflection.Debug.html#996" class="Function Operator">∷ᵈ</a> <a id="5379" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a><a id="5381" class="Symbol">)</a>
    <a id="5387" href="Tactic.DeriveComp.html#5387" class="Bound">stsConstrs</a> <a id="5398" href="Interface.Monad.html#311" class="Field Operator">←</a> <a id="5400" href="Tactic.DeriveComp.html#2399" class="Function">getSTSConstrs</a> <a id="5414" href="Tactic.DeriveComp.html#5292" class="Bound">definedType</a>
    <a id="5430" href="Interface.MonadTC.html#8620" class="Function">debugLog1</a> <a id="5440" class="Symbol">(</a><a id="5441" href="Tactic.DeriveComp.html#3458" class="Function">generateFunction</a> <a id="5458" href="Tactic.DeriveComp.html#5387" class="Bound">stsConstrs</a><a id="5468" class="Symbol">)</a>
    <a id="5474" class="Comment">--return $ generateFunction stsConstrs</a>
    <a id="5517" href="Interface.MonadTC.html#10332" class="Function">unifyWithGoal</a> <a id="5531" class="Symbol">(</a><a id="5532" href="Tactic.DeriveComp.html#3458" class="Function">generateFunction</a> <a id="5549" href="Tactic.DeriveComp.html#5387" class="Bound">stsConstrs</a><a id="5559" class="Symbol">)</a>

  <a id="5564" class="Keyword">macro</a>
    <a id="5574" href="Tactic.DeriveComp.html#5574" class="Function">by-derive⇔</a> <a id="5585" class="Symbol">:</a> <a id="5587" href="Agda.Builtin.Reflection.html#471" class="Postulate">Name</a> <a id="5592" class="Symbol">→</a> <a id="5594" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="5599" href="Tactic.DeriveComp.html#846" class="Record">STSConstr</a> <a id="5609" class="Symbol">→</a> <a id="5611" href="Generics.Core.html#2462" class="Function">Tactic</a>
    <a id="5622" href="Tactic.DeriveComp.html#5574" class="Function">by-derive⇔</a> <a id="5633" class="Symbol">=</a> <a id="5635" href="Tactic.DeriveComp.html#4970" class="Function">derive⇔</a>

  <a id="5646" href="Tactic.DeriveComp.html#5646" class="Function">deriveComputational</a> <a id="5666" class="Symbol">:</a> <a id="5668" href="Agda.Builtin.Reflection.html#471" class="Postulate">Name</a> <a id="5673" class="Symbol">→</a> <a id="5675" href="Agda.Builtin.Reflection.html#471" class="Postulate">Name</a> <a id="5680" class="Symbol">→</a> <a id="5682" href="Generics.Core.html#2484" class="Function">UnquoteDecl</a>
  <a id="5696" href="Tactic.DeriveComp.html#5646" class="Function">deriveComputational</a> <a id="5716" href="Tactic.DeriveComp.html#5716" class="Bound">n</a> <a id="5718" href="Tactic.DeriveComp.html#5718" class="Bound">compName</a> <a id="5727" class="Symbol">=</a>
    <a id="5733" href="Tactic.Helpers.html#6018" class="Function">initUnquoteWithGoal</a> <a id="5753" class="Symbol">(</a><a id="5754" class="Keyword">quoteTerm</a> <a id="5764" href="Agda.Builtin.Reflection.html#471" class="Postulate">Name</a><a id="5768" class="Symbol">)</a> <a id="5770" href="Function.Base.html#1994" class="Function Operator">$</a> <a id="5772" href="Tactic.Helpers.html#2528" class="Function">inDebugPath</a> <a id="5784" class="String">&quot;deriveComputational&quot;</a> <a id="5806" class="Keyword">do</a>
      <a id="5815" class="Keyword">let</a> <a id="5819" href="Tactic.DeriveComp.html#5819" class="Bound">goalTy</a> <a id="5826" class="Symbol">=</a> <a id="5828" class="Keyword">quote</a> <a id="5834" href="Interface.ComputationalRelation.html#570" class="Record">Computational</a> <a id="5848" href="Generics.Core.html#1847" class="InductiveConstructor Operator">∙⟦</a> <a id="5851" href="Tactic.DeriveComp.html#5716" class="Bound">n</a> <a id="5853" href="Generics.Core.html#1823" class="InductiveConstructor Operator">∙</a> <a id="5855" href="Generics.Core.html#1847" class="InductiveConstructor Operator">⟧</a>
      <a id="5863" href="Interface.MonadTC.html#8620" class="Function">debugLog1</a> <a id="5873" href="Tactic.DeriveComp.html#5819" class="Bound">goalTy</a>
      <a id="5886" href="Interface.MonadTC.html#1932" class="Field">declareDef</a> <a id="5897" class="Symbol">(</a><a id="5898" href="Reflection.AST.Argument.html#1295" class="InductiveConstructor">vArg</a> <a id="5903" href="Tactic.DeriveComp.html#5718" class="Bound">compName</a><a id="5911" class="Symbol">)</a> <a id="5913" href="Tactic.DeriveComp.html#5819" class="Bound">goalTy</a>
      <a id="5926" href="Tactic.DeriveComp.html#5926" class="Bound">compRes</a> <a id="5934" href="Interface.Monad.html#311" class="Field Operator">←</a> <a id="5936" href="Tactic.Helpers.html#5060" class="Function">withSafeReset</a> <a id="5950" href="Function.Base.html#1994" class="Function Operator">$</a> <a id="5952" class="Keyword">do</a>
        <a id="5963" href="Tactic.DeriveComp.html#5963" class="Bound">compHole</a> <a id="5972" href="Interface.Monad.html#311" class="Field Operator">←</a> <a id="5974" href="Interface.MonadTC.html#4018" class="Function">newMeta</a> <a id="5982" href="Agda.Builtin.Reflection.html#5271" class="InductiveConstructor">unknown</a>
        <a id="5998" href="Tactic.DeriveComp.html#5998" class="Bound">equivHole</a> <a id="6008" href="Interface.Monad.html#311" class="Field Operator">←</a> <a id="6010" href="Interface.MonadTC.html#4018" class="Function">newMeta</a> <a id="6018" href="Agda.Builtin.Reflection.html#5271" class="InductiveConstructor">unknown</a>
        <a id="6034" href="Tactic.DeriveComp.html#6034" class="Bound">definition</a> <a id="6045" href="Interface.Monad.html#311" class="Field Operator">←</a> <a id="6047" href="Interface.MonadTC.html#3435" class="Function">mkRecord</a> <a id="6056" class="Symbol">(</a><a id="6057" class="Keyword">quote</a> <a id="6063" href="Interface.ComputationalRelation.html#570" class="Record">Computational</a><a id="6076" class="Symbol">)</a> <a id="6078" class="Symbol">(</a><a id="6079" href="Tactic.DeriveComp.html#5963" class="Bound">compHole</a> <a id="6088" href="Reflection.AST.Argument.html#1687" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="6092" href="Tactic.DeriveComp.html#5998" class="Bound">equivHole</a> <a id="6102" href="Reflection.AST.Argument.html#1687" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="6106" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a><a id="6108" class="Symbol">)</a>
        <a id="6118" class="Symbol">_</a> <a id="6120" href="Interface.Monad.html#311" class="Field Operator">←</a> <a id="6122" href="Interface.MonadTC.html#1658" class="Field">checkType</a> <a id="6132" href="Tactic.DeriveComp.html#6034" class="Bound">definition</a> <a id="6143" href="Tactic.DeriveComp.html#5819" class="Bound">goalTy</a>
        <a id="6158" href="Interface.MonadTC.html#5942" class="Function">debugLog1ᵐ</a> <a id="6169" class="Symbol">(</a><a id="6170" href="Tactic.DeriveComp.html#5963" class="Bound">compHole</a> <a id="6179" href="Interface.MonadTC.html#5482" class="Function Operator">ᵗ</a><a id="6180" class="Symbol">)</a>
        <a id="6190" href="Interface.MonadTC.html#10492" class="Function">runWithHole</a> <a id="6202" href="Tactic.DeriveComp.html#5963" class="Bound">compHole</a> <a id="6211" href="Function.Base.html#1994" class="Function Operator">$</a> <a id="6213" href="Tactic.DeriveComp.html#5254" class="Function">deriveComp</a> <a id="6224" href="Tactic.DeriveComp.html#5716" class="Bound">n</a>
        <a id="6234" href="Interface.MonadTC.html#1739" class="Field">reduce</a> <a id="6241" href="Tactic.DeriveComp.html#5963" class="Bound">compHole</a>
      <a id="6256" href="Interface.MonadTC.html#5576" class="Function">debugLog</a> <a id="6265" class="Symbol">(</a><a id="6266" class="String">&quot;compRes: &quot;</a> <a id="6278" href="Reflection.Debug.html#996" class="Function Operator">∷ᵈ</a> <a id="6281" href="Tactic.DeriveComp.html#5926" class="Bound">compRes</a> <a id="6289" href="Reflection.Debug.html#996" class="Function Operator">∷ᵈ</a> <a id="6292" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a><a id="6294" class="Symbol">)</a>
      <a id="6302" href="Tactic.DeriveComp.html#6302" class="Bound">stsConstrs</a> <a id="6313" href="Interface.Monad.html#311" class="Field Operator">←</a> <a id="6315" href="Interface.MonadTC.html#1776" class="Field">quoteTC</a> <a id="6323" href="Interface.Monad.html#400" class="Function Operator">=&lt;&lt;</a> <a id="6327" href="Tactic.DeriveComp.html#2399" class="Function">getSTSConstrs</a> <a id="6341" href="Tactic.DeriveComp.html#5716" class="Bound">n</a>
      <a id="6349" href="Tactic.DeriveComp.html#6349" class="Bound">definition</a> <a id="6360" href="Interface.Monad.html#311" class="Field Operator">←</a> <a id="6362" href="Interface.MonadTC.html#3435" class="Function">mkRecord</a> <a id="6371" class="Symbol">(</a><a id="6372" class="Keyword">quote</a> <a id="6378" href="Interface.ComputationalRelation.html#570" class="Record">Computational</a><a id="6391" class="Symbol">)</a> <a id="6393" class="Symbol">(</a><a id="6394" href="Tactic.DeriveComp.html#5926" class="Bound">compRes</a> <a id="6402" href="Reflection.AST.Argument.html#1687" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="6406" class="Keyword">quote</a> <a id="6412" href="Tactic.DeriveComp.html#5574" class="Macro">by-derive⇔</a> <a id="6423" href="Generics.Core.html#1887" class="InductiveConstructor Operator">∙⟦</a> <a id="6426" href="Tactic.DeriveComp.html#5716" class="Bound">n</a> <a id="6428" href="Generics.Core.html#1823" class="InductiveConstructor Operator">∙</a> <a id="6430" href="Generics.Core.html#1887" class="InductiveConstructor Operator">∣</a> <a id="6432" href="Tactic.DeriveComp.html#6302" class="Bound">stsConstrs</a> <a id="6443" href="Generics.Core.html#1887" class="InductiveConstructor Operator">⟧</a> <a id="6445" href="Reflection.AST.Argument.html#1687" class="InductiveConstructor Operator">⟨∷⟩</a> <a id="6449" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a><a id="6451" class="Symbol">)</a>
      <a id="6459" href="Interface.MonadTC.html#2022" class="Field">defineFun</a> <a id="6469" href="Tactic.DeriveComp.html#5718" class="Bound">compName</a> <a id="6478" href="Data.List.Base.html#5219" class="Function Operator">[</a> <a id="6480" href="Tactic.ClauseBuilder.html#7417" class="Function">nonBindingClause</a> <a id="6497" href="Tactic.DeriveComp.html#6349" class="Bound">definition</a> <a id="6508" href="Data.List.Base.html#5219" class="Function Operator">]</a>

<a id="6511" class="Keyword">private</a>
  <a id="6521" class="Comment">--open import Tactic.Defaults</a>
  <a id="6553" class="Keyword">open</a> <a id="6558" class="Keyword">import</a> <a id="6565" href="MyDebugOptions.html" class="Module">MyDebugOptions</a>

  <a id="6583" class="Keyword">module</a> <a id="6590" href="Tactic.DeriveComp.html#6590" class="Module">_</a> <a id="6592" class="Symbol">{</a><a id="6593" href="Tactic.DeriveComp.html#6593" class="Bound">A</a> <a id="6595" href="Tactic.DeriveComp.html#6595" class="Bound">B</a> <a id="6597" class="Symbol">:</a> <a id="6599" href="Agda.Primitive.html#320" class="Primitive">Set</a><a id="6602" class="Symbol">}</a> <a id="6604" class="Symbol">⦃</a> <a id="6606" href="Tactic.DeriveComp.html#6606" class="Bound">_</a> <a id="6608" class="Symbol">:</a> <a id="6610" href="Interface.DecEq.html#185" class="Record">DecEq</a> <a id="6616" href="Tactic.DeriveComp.html#6593" class="Bound">A</a> <a id="6618" class="Symbol">⦄</a> <a id="6620" class="Symbol">⦃</a> <a id="6622" href="Tactic.DeriveComp.html#6622" class="Bound">_</a> <a id="6624" class="Symbol">:</a> <a id="6626" href="Interface.DecEq.html#185" class="Record">DecEq</a> <a id="6632" href="Tactic.DeriveComp.html#6595" class="Bound">B</a> <a id="6634" class="Symbol">⦄</a> <a id="6636" class="Keyword">where</a>
    <a id="6646" class="Keyword">variable</a> <a id="6655" href="Tactic.DeriveComp.html#6655" class="Generalizable">c</a> <a id="6657" class="Symbol">:</a> <a id="6659" href="Tactic.DeriveComp.html#6593" class="Bound">A</a> <a id="6661" href="Data.Product.Base.html#1109" class="Function Operator">×</a> <a id="6663" href="Tactic.DeriveComp.html#6595" class="Bound">B</a>
             <a id="6678" href="Tactic.DeriveComp.html#6678" class="Generalizable">s</a> <a id="6680" href="Tactic.DeriveComp.html#6680" class="Generalizable">s&#39;</a> <a id="6683" class="Symbol">:</a> <a id="6685" href="Tactic.DeriveComp.html#6593" class="Bound">A</a>
             <a id="6700" href="Tactic.DeriveComp.html#6700" class="Generalizable">sig</a> <a id="6704" class="Symbol">:</a> <a id="6706" href="Tactic.DeriveComp.html#6595" class="Bound">B</a>

    <a id="6713" class="Keyword">data</a> <a id="6718" href="Tactic.DeriveComp.html#6718" class="Datatype">Test</a> <a id="6723" class="Symbol">:</a> <a id="6725" href="Tactic.DeriveComp.html#6593" class="Bound">A</a> <a id="6727" href="Data.Product.Base.html#1109" class="Function Operator">×</a> <a id="6729" href="Tactic.DeriveComp.html#6595" class="Bound">B</a> <a id="6731" class="Symbol">→</a> <a id="6733" href="Tactic.DeriveComp.html#6593" class="Bound">A</a> <a id="6735" class="Symbol">→</a> <a id="6737" href="Tactic.DeriveComp.html#6595" class="Bound">B</a> <a id="6739" class="Symbol">→</a> <a id="6741" href="Tactic.DeriveComp.html#6593" class="Bound">A</a> <a id="6743" class="Symbol">→</a> <a id="6745" href="Agda.Primitive.html#320" class="Primitive">Set</a> <a id="6749" class="Keyword">where</a>
      <a id="6761" href="Tactic.DeriveComp.html#6761" class="InductiveConstructor">test</a> <a id="6766" class="Symbol">:</a> <a id="6768" href="Data.Product.Base.html#608" class="Field">proj₁</a> <a id="6774" href="Tactic.DeriveComp.html#6655" class="Generalizable">c</a> <a id="6776" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="6778" href="Tactic.DeriveComp.html#6678" class="Generalizable">s</a>
           <a id="6791" class="Symbol">→</a> <a id="6793" href="Data.Product.Base.html#622" class="Field">proj₂</a> <a id="6799" href="Tactic.DeriveComp.html#6655" class="Generalizable">c</a> <a id="6801" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="6803" href="Tactic.DeriveComp.html#6700" class="Generalizable">sig</a>
           <a id="6818" class="Comment">------------------------</a>
           <a id="6854" class="Symbol">→</a> <a id="6856" href="Tactic.DeriveComp.html#6718" class="Datatype">Test</a> <a id="6861" href="Tactic.DeriveComp.html#6655" class="Generalizable">c</a> <a id="6863" href="Tactic.DeriveComp.html#6678" class="Generalizable">s</a> <a id="6865" href="Tactic.DeriveComp.html#6700" class="Generalizable">sig</a> <a id="6869" class="Symbol">(</a><a id="6870" href="Data.Product.Base.html#608" class="Field">proj₁</a> <a id="6876" href="Tactic.DeriveComp.html#6655" class="Generalizable">c</a><a id="6877" class="Symbol">)</a>

    <a id="6884" class="Keyword">unquoteDecl</a> <a id="6896" href="Tactic.DeriveComp.html#6896" class="Function">Computational-Test</a> <a id="6915" class="Symbol">=</a> <a id="6917" href="Tactic.DeriveComp.html#5646" class="Function">deriveComputational</a> <a id="6937" class="Symbol">(</a><a id="6938" class="Keyword">quote</a> <a id="6944" href="Tactic.DeriveComp.html#6718" class="Datatype">Test</a><a id="6948" class="Symbol">)</a> <a id="6950" href="Tactic.DeriveComp.html#6896" class="Function">Computational-Test</a>

    <a id="6974" href="Tactic.DeriveComp.html#6974" class="Function">Computational-Test&#39;</a> <a id="6994" class="Symbol">:</a> <a id="6996" href="Interface.ComputationalRelation.html#570" class="Record">Computational</a> <a id="7010" href="Tactic.DeriveComp.html#6718" class="Datatype">Test</a>
    <a id="7019" href="Tactic.DeriveComp.html#6974" class="Function">Computational-Test&#39;</a> <a id="7039" class="Symbol">=</a> <a id="7041" href="Tactic.DeriveComp.html#6896" class="Function">Computational-Test</a>

    <a id="7065" class="Comment">-- Sanity checks</a>
    <a id="7086" href="Tactic.DeriveComp.html#7086" class="Function">testFun</a> <a id="7094" class="Symbol">:</a> <a id="7096" href="Tactic.DeriveComp.html#6593" class="Bound">A</a> <a id="7098" href="Data.Product.Base.html#1109" class="Function Operator">×</a> <a id="7100" href="Tactic.DeriveComp.html#6595" class="Bound">B</a> <a id="7102" class="Symbol">→</a> <a id="7104" href="Tactic.DeriveComp.html#6593" class="Bound">A</a> <a id="7106" class="Symbol">→</a> <a id="7108" href="Tactic.DeriveComp.html#6595" class="Bound">B</a> <a id="7110" class="Symbol">→</a> <a id="7112" href="Agda.Builtin.Maybe.html#118" class="Datatype">Maybe</a> <a id="7118" href="Tactic.DeriveComp.html#6593" class="Bound">A</a>
    <a id="7124" href="Tactic.DeriveComp.html#7086" class="Function">testFun</a> <a id="7132" href="Tactic.DeriveComp.html#7132" class="Bound">c</a> <a id="7134" href="Tactic.DeriveComp.html#7134" class="Bound">s</a> <a id="7136" href="Tactic.DeriveComp.html#7136" class="Bound">sig</a> <a id="7140" class="Symbol">=</a> <a id="7142" href="Data.Bool.Base.html#1283" class="Function Operator">if</a> <a id="7145" href="Relation.Nullary.Decidable.Core.html#3274" class="Function Operator">⌊</a> <a id="7147" href="Interface.Decidable.Instance.html#583" class="Function Operator">¿</a> <a id="7149" href="Data.Product.Base.html#608" class="Field">proj₁</a> <a id="7155" href="Tactic.DeriveComp.html#7132" class="Bound">c</a> <a id="7157" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="7159" href="Tactic.DeriveComp.html#7134" class="Bound">s</a> <a id="7161" href="Data.Product.Base.html#1109" class="Function Operator">×</a> <a id="7163" href="Data.Product.Base.html#622" class="Field">proj₂</a> <a id="7169" href="Tactic.DeriveComp.html#7132" class="Bound">c</a> <a id="7171" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="7173" href="Tactic.DeriveComp.html#7136" class="Bound">sig</a> <a id="7177" href="Interface.Decidable.Instance.html#583" class="Function Operator">¿</a> <a id="7179" href="Relation.Nullary.Decidable.Core.html#3274" class="Function Operator">⌋</a> <a id="7181" href="Data.Bool.Base.html#1283" class="Function Operator">then</a> <a id="7186" href="Agda.Builtin.Maybe.html#156" class="InductiveConstructor">just</a> <a id="7191" class="Symbol">(</a><a id="7192" href="Data.Product.Base.html#608" class="Field">proj₁</a> <a id="7198" href="Tactic.DeriveComp.html#7132" class="Bound">c</a><a id="7199" class="Symbol">)</a> <a id="7201" href="Data.Bool.Base.html#1283" class="Function Operator">else</a> <a id="7206" href="Agda.Builtin.Maybe.html#177" class="InductiveConstructor">nothing</a>

    <a id="7219" href="Tactic.DeriveComp.html#7219" class="Function">testFunPf⇒</a> <a id="7230" class="Symbol">:</a> <a id="7232" href="Tactic.DeriveComp.html#7086" class="Function">testFun</a> <a id="7240" href="Tactic.DeriveComp.html#6655" class="Generalizable">c</a> <a id="7242" href="Tactic.DeriveComp.html#6678" class="Generalizable">s</a> <a id="7244" href="Tactic.DeriveComp.html#6700" class="Generalizable">sig</a> <a id="7248" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="7250" href="Agda.Builtin.Maybe.html#156" class="InductiveConstructor">just</a> <a id="7255" href="Tactic.DeriveComp.html#6680" class="Generalizable">s&#39;</a> <a id="7258" class="Symbol">→</a> <a id="7260" href="Tactic.DeriveComp.html#6718" class="Datatype">Test</a> <a id="7265" href="Tactic.DeriveComp.html#6655" class="Generalizable">c</a> <a id="7267" href="Tactic.DeriveComp.html#6678" class="Generalizable">s</a> <a id="7269" href="Tactic.DeriveComp.html#6700" class="Generalizable">sig</a> <a id="7273" href="Tactic.DeriveComp.html#6680" class="Generalizable">s&#39;</a>
    <a id="7280" href="Tactic.DeriveComp.html#7219" class="Function">testFunPf⇒</a> <a id="7291" class="Symbol">{</a><a id="7292" href="Tactic.DeriveComp.html#7292" class="Bound">c</a><a id="7293" class="Symbol">}</a> <a id="7295" class="Symbol">{</a><a id="7296" href="Tactic.DeriveComp.html#7296" class="Bound">s</a><a id="7297" class="Symbol">}</a> <a id="7299" class="Symbol">{</a><a id="7300" href="Tactic.DeriveComp.html#7300" class="Bound">sig</a><a id="7303" class="Symbol">}</a> <a id="7305" href="Tactic.DeriveComp.html#7305" class="Bound">h</a> <a id="7307" class="Symbol">=</a> <a id="7309" href="Function.Base.html#4053" class="Function Operator">case</a> <a id="7314" href="Interface.Decidable.Instance.html#583" class="Function Operator">¿</a> <a id="7316" href="Data.Product.Base.html#608" class="Field">proj₁</a> <a id="7322" href="Tactic.DeriveComp.html#7292" class="Bound">c</a> <a id="7324" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="7326" href="Tactic.DeriveComp.html#7296" class="Bound">s</a> <a id="7328" href="Data.Product.Base.html#1109" class="Function Operator">×</a> <a id="7330" href="Data.Product.Base.html#622" class="Field">proj₂</a> <a id="7336" href="Tactic.DeriveComp.html#7292" class="Bound">c</a> <a id="7338" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="7340" href="Tactic.DeriveComp.html#7300" class="Bound">sig</a> <a id="7344" href="Interface.Decidable.Instance.html#583" class="Function Operator">¿</a> <a id="7346" href="Function.Base.html#4053" class="Function Operator">of</a> <a id="7349" class="Symbol">λ</a> <a id="7351" class="Keyword">where</a>
      <a id="7363" class="Symbol">(</a><a id="7364" href="Relation.Nullary.Decidable.Core.html#1650" class="InductiveConstructor">no</a> <a id="7367" href="Tactic.DeriveComp.html#7367" class="Bound">¬p</a><a id="7369" class="Symbol">)</a> <a id="7371" class="Symbol">→</a> <a id="7373" href="Function.Base.html#4053" class="Function Operator">case</a> <a id="7378" href="Tactic.ReduceDec.html#5259" class="Macro">by-reduceDec</a> <a id="7391" href="Tactic.DeriveComp.html#7305" class="Bound">h</a> <a id="7393" href="Function.Base.html#4053" class="Function Operator">of</a> <a id="7396" class="Symbol">λ</a> <a id="7398" class="Symbol">()</a>
      <a id="7407" class="Symbol">(</a><a id="7408" href="Relation.Nullary.Decidable.Core.html#1613" class="InductiveConstructor">yes</a> <a id="7412" href="Tactic.DeriveComp.html#7412" class="Bound">p</a><a id="7413" class="Symbol">)</a> <a id="7415" class="Symbol">→</a> <a id="7417" href="Relation.Binary.PropositionalEquality.Core.html#1794" class="Function">subst</a> <a id="7423" class="Symbol">(</a><a id="7424" href="Tactic.DeriveComp.html#6718" class="Datatype">Test</a> <a id="7429" href="Tactic.DeriveComp.html#7292" class="Bound">c</a> <a id="7431" href="Tactic.DeriveComp.html#7296" class="Bound">s</a> <a id="7433" href="Tactic.DeriveComp.html#7300" class="Bound">sig</a><a id="7436" class="Symbol">)</a> <a id="7438" class="Symbol">(</a><a id="7439" href="Data.Maybe.Properties.html#947" class="Function">just-injective</a> <a id="7454" href="Function.Base.html#1994" class="Function Operator">$</a> <a id="7456" href="Tactic.ReduceDec.html#5259" class="Macro">by-reduceDec</a> <a id="7469" href="Tactic.DeriveComp.html#7305" class="Bound">h</a><a id="7470" class="Symbol">)</a> <a id="7472" class="Symbol">(</a><a id="7473" href="Tactic.DeriveComp.html#6761" class="InductiveConstructor">test</a> <a id="7478" class="Symbol">(</a><a id="7479" href="Data.Product.Base.html#608" class="Field">proj₁</a> <a id="7485" href="Tactic.DeriveComp.html#7412" class="Bound">p</a><a id="7486" class="Symbol">)</a> <a id="7488" class="Symbol">(</a><a id="7489" href="Data.Product.Base.html#622" class="Field">proj₂</a> <a id="7495" href="Tactic.DeriveComp.html#7412" class="Bound">p</a><a id="7496" class="Symbol">))</a>

    <a id="7504" href="Tactic.DeriveComp.html#7504" class="Function">testFunPf⇐</a> <a id="7515" class="Symbol">:</a> <a id="7517" href="Tactic.DeriveComp.html#6718" class="Datatype">Test</a> <a id="7522" href="Tactic.DeriveComp.html#6655" class="Generalizable">c</a> <a id="7524" href="Tactic.DeriveComp.html#6678" class="Generalizable">s</a> <a id="7526" href="Tactic.DeriveComp.html#6700" class="Generalizable">sig</a> <a id="7530" href="Tactic.DeriveComp.html#6680" class="Generalizable">s&#39;</a> <a id="7533" class="Symbol">→</a> <a id="7535" href="Tactic.DeriveComp.html#7086" class="Function">testFun</a> <a id="7543" href="Tactic.DeriveComp.html#6655" class="Generalizable">c</a> <a id="7545" href="Tactic.DeriveComp.html#6678" class="Generalizable">s</a> <a id="7547" href="Tactic.DeriveComp.html#6700" class="Generalizable">sig</a> <a id="7551" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="7553" href="Agda.Builtin.Maybe.html#156" class="InductiveConstructor">just</a> <a id="7558" href="Tactic.DeriveComp.html#6680" class="Generalizable">s&#39;</a>
    <a id="7565" href="Tactic.DeriveComp.html#7504" class="Function">testFunPf⇐</a> <a id="7576" class="Symbol">{</a><a id="7577" class="Argument">s</a> <a id="7579" class="Symbol">=</a> <a id="7581" href="Tactic.DeriveComp.html#7581" class="Bound">s</a><a id="7582" class="Symbol">}</a> <a id="7584" class="Symbol">(</a><a id="7585" href="Tactic.DeriveComp.html#6761" class="InductiveConstructor">test</a> <a id="7590" href="Tactic.DeriveComp.html#7590" class="Bound">x</a> <a id="7592" href="Tactic.DeriveComp.html#7592" class="Bound">x₁</a><a id="7594" class="Symbol">)</a> <a id="7596" class="Symbol">=</a> <a id="7598" href="Tactic.ReduceDec.html#5346" class="Macro">by-reduceDecInGoal</a> <a id="7617" class="Symbol">(</a><a id="7618" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a> <a id="7623" class="Symbol">{</a><a id="7624" class="Argument">x</a> <a id="7626" class="Symbol">=</a> <a id="7628" href="Agda.Builtin.Maybe.html#156" class="InductiveConstructor">just</a> <a id="7633" href="Tactic.DeriveComp.html#7581" class="Bound">s</a><a id="7634" class="Symbol">})</a>

    <a id="7642" href="Tactic.DeriveComp.html#7642" class="Function">Computational-Test-Manual</a> <a id="7668" class="Symbol">:</a> <a id="7670" href="Interface.ComputationalRelation.html#570" class="Record">Computational</a> <a id="7684" href="Tactic.DeriveComp.html#6718" class="Datatype">Test</a>
    <a id="7693" href="Tactic.DeriveComp.html#7642" class="Function">Computational-Test-Manual</a> <a id="7719" class="Symbol">=</a> <a id="7721" class="Keyword">record</a> <a id="7728" class="Symbol">{</a> <a id="7730" href="Interface.ComputationalRelation.html#644" class="Field">compute</a> <a id="7738" class="Symbol">=</a> <a id="7740" href="Tactic.DeriveComp.html#7086" class="Function">testFun</a> <a id="7748" class="Symbol">;</a> <a id="7750" href="Interface.ComputationalRelation.html#682" class="Field">≡-just⇔STS</a> <a id="7761" class="Symbol">=</a> <a id="7763" href="Function.Bundles.html#10043" class="Function">mk⇔</a> <a id="7767" href="Tactic.DeriveComp.html#7219" class="Function">testFunPf⇒</a> <a id="7778" href="Tactic.DeriveComp.html#7504" class="Function">testFunPf⇐</a> <a id="7789" class="Symbol">}</a>

    <a id="7796" href="Tactic.DeriveComp.html#7796" class="Function">testFun≡compute</a> <a id="7812" class="Symbol">:</a> <a id="7814" class="Symbol">∀</a> <a id="7816" class="Symbol">{</a><a id="7817" href="Tactic.DeriveComp.html#7817" class="Bound">c</a> <a id="7819" href="Tactic.DeriveComp.html#7819" class="Bound">s</a> <a id="7821" href="Tactic.DeriveComp.html#7821" class="Bound">sig</a><a id="7824" class="Symbol">}</a> <a id="7826" class="Symbol">→</a> <a id="7828" href="Tactic.DeriveComp.html#7086" class="Function">testFun</a> <a id="7836" href="Tactic.DeriveComp.html#7817" class="Bound">c</a> <a id="7838" href="Tactic.DeriveComp.html#7819" class="Bound">s</a> <a id="7840" href="Tactic.DeriveComp.html#7821" class="Bound">sig</a> <a id="7844" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="7846" href="Interface.ComputationalRelation.html#644" class="Field">Computational.compute</a> <a id="7868" href="Tactic.DeriveComp.html#6896" class="Function">Computational-Test</a> <a id="7887" href="Tactic.DeriveComp.html#7817" class="Bound">c</a> <a id="7889" href="Tactic.DeriveComp.html#7819" class="Bound">s</a> <a id="7891" href="Tactic.DeriveComp.html#7821" class="Bound">sig</a>
    <a id="7899" href="Tactic.DeriveComp.html#7796" class="Function">testFun≡compute</a> <a id="7915" class="Symbol">=</a> <a id="7917" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a>
</pre></body></html>