<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Ledger.Crypto</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Background">\section{Cryptographic primitives}
</a><a id="36" class="Markup">\begin{code}[hide]</a>
<a id="55" class="Symbol">{-#</a> <a id="59" class="Keyword">OPTIONS</a> <a id="67" class="Pragma">--safe</a> <a id="74" class="Symbol">#-}</a>
<a id="78" class="Keyword">module</a> <a id="85" href="Ledger.Crypto.html" class="Module">Ledger.Crypto</a> <a id="99" class="Keyword">where</a>

<a id="106" class="Keyword">open</a> <a id="111" class="Keyword">import</a> <a id="118" href="Ledger.Prelude.html" class="Module">Ledger.Prelude</a> <a id="133" class="Keyword">hiding</a> <a id="140" class="Symbol">(</a><a id="141" href="Data.Bool.Base.html#1451" class="Function">T</a><a id="142" class="Symbol">)</a>
<a id="144" class="Keyword">open</a> <a id="149" class="Keyword">import</a> <a id="156" href="Interface.Hashable.html" class="Module">Interface.Hashable</a> <a id="175" class="Keyword">public</a>

<a id="183" class="Keyword">record</a> <a id="isHashableSet"></a><a id="190" href="Ledger.Crypto.html#190" class="Record">isHashableSet</a> <a id="204" class="Symbol">(</a><a id="205" href="Ledger.Crypto.html#205" class="Bound">T</a> <a id="207" class="Symbol">:</a> <a id="209" href="Agda.Primitive.html#320" class="Primitive">Set</a><a id="212" class="Symbol">)</a> <a id="214" class="Symbol">:</a> <a id="216" href="Agda.Primitive.html#320" class="Primitive">Set₁</a> <a id="221" class="Keyword">where</a>
  <a id="229" class="Keyword">field</a> <a id="isHashableSet.THash"></a><a id="235" href="Ledger.Crypto.html#235" class="Field">THash</a> <a id="241" class="Symbol">:</a> <a id="243" href="Agda.Primitive.html#320" class="Primitive">Set</a>
        <a id="255" class="Keyword">instance</a> <a id="isHashableSet.T-Hashable"></a><a id="264" href="Ledger.Crypto.html#264" class="Field">T-Hashable</a> <a id="275" class="Symbol">:</a> <a id="277" href="Interface.Hashable.html#64" class="Record">Hashable</a> <a id="286" href="Ledger.Crypto.html#205" class="Bound">T</a> <a id="288" href="Ledger.Crypto.html#235" class="Field">THash</a>
        <a id="302" class="Keyword">instance</a> <a id="isHashableSet.DecEq-THash"></a><a id="311" href="Ledger.Crypto.html#311" class="Field">DecEq-THash</a> <a id="323" class="Symbol">:</a> <a id="325" href="Interface.DecEq.html#185" class="Record">DecEq</a> <a id="331" href="Ledger.Crypto.html#235" class="Field">THash</a>
<a id="337" class="Keyword">open</a> <a id="342" href="Ledger.Crypto.html#190" class="Module">isHashableSet</a>

<a id="mkIsHashableSet"></a><a id="357" href="Ledger.Crypto.html#357" class="Function">mkIsHashableSet</a> <a id="373" class="Symbol">:</a> <a id="375" class="Symbol">(</a><a id="376" href="Ledger.Crypto.html#376" class="Bound">T</a> <a id="378" href="Ledger.Crypto.html#378" class="Bound">THash</a> <a id="384" class="Symbol">:</a> <a id="386" href="Agda.Primitive.html#320" class="Primitive">Set</a><a id="389" class="Symbol">)</a> <a id="391" class="Symbol">→</a> <a id="393" class="Symbol">(</a><a id="394" href="Ledger.Crypto.html#376" class="Bound">T</a> <a id="396" class="Symbol">→</a> <a id="398" href="Ledger.Crypto.html#378" class="Bound">THash</a><a id="403" class="Symbol">)</a> <a id="405" class="Symbol">→</a> <a id="407" class="Symbol">(</a><a id="408" href="Interface.DecEq.html#185" class="Record">DecEq</a> <a id="414" href="Ledger.Crypto.html#378" class="Bound">THash</a><a id="419" class="Symbol">)</a> <a id="421" class="Symbol">→</a> <a id="423" href="Ledger.Crypto.html#190" class="Record">isHashableSet</a> <a id="437" href="Ledger.Crypto.html#376" class="Bound">T</a>
<a id="439" href="Ledger.Crypto.html#357" class="Function">mkIsHashableSet</a> <a id="455" href="Ledger.Crypto.html#455" class="Bound">T</a> <a id="457" href="Ledger.Crypto.html#457" class="Bound">THash</a> <a id="463" href="Ledger.Crypto.html#463" class="Bound">hash</a> <a id="468" href="Ledger.Crypto.html#468" class="Bound">eq</a> <a id="471" class="Symbol">.</a><a id="472" href="Ledger.Crypto.html#235" class="Field">THash</a>            <a id="489" class="Symbol">=</a> <a id="491" href="Ledger.Crypto.html#457" class="Bound">THash</a>
<a id="497" href="Ledger.Crypto.html#357" class="Function">mkIsHashableSet</a> <a id="513" href="Ledger.Crypto.html#513" class="Bound">T</a> <a id="515" href="Ledger.Crypto.html#515" class="Bound">THash</a> <a id="521" href="Ledger.Crypto.html#521" class="Bound">hash</a> <a id="526" href="Ledger.Crypto.html#526" class="Bound">eq</a> <a id="529" class="Symbol">.</a><a id="530" href="Ledger.Crypto.html#264" class="Field">T-Hashable</a> <a id="541" class="Symbol">.</a><a id="542" href="Interface.Hashable.html#109" class="Field">hash</a> <a id="547" class="Symbol">=</a> <a id="549" href="Ledger.Crypto.html#521" class="Bound">hash</a>
<a id="554" href="Ledger.Crypto.html#357" class="Function">mkIsHashableSet</a> <a id="570" href="Ledger.Crypto.html#570" class="Bound">T</a> <a id="572" href="Ledger.Crypto.html#572" class="Bound">THash</a> <a id="578" href="Ledger.Crypto.html#578" class="Bound">hash</a> <a id="583" href="Ledger.Crypto.html#583" class="Bound">eq</a> <a id="586" class="Symbol">.</a><a id="587" href="Ledger.Crypto.html#311" class="Field">DecEq-THash</a>      <a id="604" class="Symbol">=</a> <a id="606" href="Ledger.Crypto.html#583" class="Bound">eq</a>

<a id="610" class="Keyword">record</a> <a id="HashableSet"></a><a id="617" href="Ledger.Crypto.html#617" class="Record">HashableSet</a> <a id="629" class="Symbol">:</a> <a id="631" href="Agda.Primitive.html#320" class="Primitive">Set₁</a> <a id="636" class="Keyword">where</a>
  <a id="644" class="Keyword">field</a> <a id="HashableSet.T"></a><a id="650" href="Ledger.Crypto.html#650" class="Field">T</a> <a id="652" class="Symbol">:</a> <a id="654" href="Agda.Primitive.html#320" class="Primitive">Set</a>
        <a id="HashableSet.T-isHashable"></a><a id="666" href="Ledger.Crypto.html#666" class="Field">T-isHashable</a> <a id="679" class="Symbol">:</a> <a id="681" href="Ledger.Crypto.html#190" class="Record">isHashableSet</a> <a id="695" href="Ledger.Crypto.html#650" class="Field">T</a>

  <a id="700" class="Keyword">open</a> <a id="705" href="Ledger.Crypto.html#190" class="Module">isHashableSet</a> <a id="719" href="Ledger.Crypto.html#666" class="Field">T-isHashable</a> <a id="732" class="Keyword">public</a>

<a id="740" class="Keyword">record</a> <a id="PKKScheme"></a><a id="747" href="Ledger.Crypto.html#747" class="Record">PKKScheme</a> <a id="757" class="Symbol">:</a> <a id="759" href="Agda.Primitive.html#320" class="Primitive">Set₁</a> <a id="764" class="Keyword">where</a>
  <a id="772" class="Keyword">field</a>
<a id="778" class="Markup">\end{code}</a><a id="788" class="Background">
We rely on a public key signing scheme for verification of spending.
\begin{figure*}[h]
\emph{Types \&amp; functions}
</a><a id="903" class="Markup">\begin{code}</a>
        <a id="PKKScheme.SKey"></a><a id="924" href="Ledger.Crypto.html#924" class="Field">SKey</a> <a id="PKKScheme.VKey"></a><a id="929" href="Ledger.Crypto.html#929" class="Field">VKey</a> <a id="PKKScheme.Sig"></a><a id="934" href="Ledger.Crypto.html#934" class="Field">Sig</a> <a id="PKKScheme.Ser"></a><a id="938" href="Ledger.Crypto.html#938" class="Field">Ser</a> <a id="942" class="Symbol">:</a> <a id="944" href="Agda.Primitive.html#320" class="Primitive">Set</a>
        <a id="PKKScheme.isKeyPair"></a><a id="956" href="Ledger.Crypto.html#956" class="Field">isKeyPair</a> <a id="966" class="Symbol">:</a> <a id="968" href="Ledger.Crypto.html#924" class="Field">SKey</a> <a id="973" class="Symbol">→</a> <a id="975" href="Ledger.Crypto.html#929" class="Field">VKey</a> <a id="980" class="Symbol">→</a> <a id="982" href="Agda.Primitive.html#320" class="Primitive">Set</a>
        <a id="PKKScheme.isSigned"></a><a id="994" href="Ledger.Crypto.html#994" class="Field">isSigned</a> <a id="1003" class="Symbol">:</a> <a id="1005" href="Ledger.Crypto.html#929" class="Field">VKey</a> <a id="1010" class="Symbol">→</a> <a id="1012" href="Ledger.Crypto.html#938" class="Field">Ser</a> <a id="1016" class="Symbol">→</a> <a id="1018" href="Ledger.Crypto.html#934" class="Field">Sig</a> <a id="1022" class="Symbol">→</a> <a id="1024" href="Agda.Primitive.html#320" class="Primitive">Set</a>
        <a id="PKKScheme.sign"></a><a id="1036" href="Ledger.Crypto.html#1036" class="Field">sign</a> <a id="1041" class="Symbol">:</a> <a id="1043" href="Ledger.Crypto.html#924" class="Field">SKey</a> <a id="1048" class="Symbol">→</a> <a id="1050" href="Ledger.Crypto.html#938" class="Field">Ser</a> <a id="1054" class="Symbol">→</a> <a id="1056" href="Ledger.Crypto.html#934" class="Field">Sig</a>

  <a id="PKKScheme.KeyPair"></a><a id="1063" href="Ledger.Crypto.html#1063" class="Function">KeyPair</a> <a id="1071" class="Symbol">=</a> <a id="1073" href="Data.Product.Base.html#858" class="Function">Σ[</a> <a id="1076" href="Ledger.Crypto.html#1076" class="Bound">sk</a> <a id="1079" href="Data.Product.Base.html#858" class="Function">∈</a> <a id="1081" href="Ledger.Crypto.html#924" class="Field">SKey</a> <a id="1086" href="Data.Product.Base.html#858" class="Function">]</a> <a id="1088" href="Data.Product.Base.html#858" class="Function">Σ[</a> <a id="1091" href="Ledger.Crypto.html#1091" class="Bound">vk</a> <a id="1094" href="Data.Product.Base.html#858" class="Function">∈</a> <a id="1096" href="Ledger.Crypto.html#929" class="Field">VKey</a> <a id="1101" href="Data.Product.Base.html#858" class="Function">]</a> <a id="1103" href="Ledger.Crypto.html#956" class="Field">isKeyPair</a> <a id="1113" href="Ledger.Crypto.html#1076" class="Bound">sk</a> <a id="1116" href="Ledger.Crypto.html#1091" class="Bound">vk</a>
<a id="1119" class="Markup">\end{code}</a><a id="1129" class="Background">
\emph{Property of signatures}
</a><a id="1160" class="Markup">\begin{code}[hide]</a>
  <a id="1181" class="Keyword">field</a> <a id="PKKScheme.isSigned?"></a><a id="1187" href="Ledger.Crypto.html#1187" class="Field">isSigned?</a> <a id="1197" class="Symbol">:</a> <a id="1199" class="Symbol">∀</a> <a id="1201" href="Ledger.Crypto.html#1201" class="Bound">vk</a> <a id="1204" href="Ledger.Crypto.html#1204" class="Bound">d</a> <a id="1206" href="Ledger.Crypto.html#1206" class="Bound">σ</a> <a id="1208" class="Symbol">→</a> <a id="1210" href="Relation.Nullary.Decidable.Core.html#1476" class="Record">Dec</a> <a id="1214" class="Symbol">(</a><a id="1215" href="Ledger.Crypto.html#994" class="Field">isSigned</a> <a id="1224" href="Ledger.Crypto.html#1201" class="Bound">vk</a> <a id="1227" href="Ledger.Crypto.html#1204" class="Bound">d</a> <a id="1229" href="Ledger.Crypto.html#1206" class="Bound">σ</a><a id="1230" class="Symbol">)</a>
        <a id="PKKScheme.isSigned-correct"></a><a id="1240" href="Ledger.Crypto.html#1240" class="Field">isSigned-correct</a> <a id="1257" class="Symbol">:</a>
<a id="1259" class="Markup">\end{code}</a><a id="1269" class="Background">
</a><a id="1270" class="Markup">\begin{code}</a>
          <a id="1293" class="Symbol">(</a><a id="1294" href="Ledger.Crypto.html#1294" class="Bound">(</a><a id="1295" href="Ledger.Crypto.html#1295" class="Bound">sk</a> <a id="1298" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="1300" href="Ledger.Crypto.html#1300" class="Bound">vk</a> <a id="1303" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="1305" href="Ledger.Crypto.html#1294" class="Bound">_)</a> <a id="1308" class="Symbol">:</a> <a id="1310" href="Ledger.Crypto.html#1063" class="Function">KeyPair</a><a id="1317" class="Symbol">)</a> <a id="1319" class="Symbol">(</a><a id="1320" href="Ledger.Crypto.html#1320" class="Bound">d</a> <a id="1322" class="Symbol">:</a> <a id="1324" href="Ledger.Crypto.html#938" class="Field">Ser</a><a id="1327" class="Symbol">)</a> <a id="1329" class="Symbol">(</a><a id="1330" href="Ledger.Crypto.html#1330" class="Bound">σ</a> <a id="1332" class="Symbol">:</a> <a id="1334" href="Ledger.Crypto.html#934" class="Field">Sig</a><a id="1337" class="Symbol">)</a> <a id="1339" class="Symbol">→</a> <a id="1341" href="Ledger.Crypto.html#1036" class="Field">sign</a> <a id="1346" href="Ledger.Crypto.html#1295" class="Bound">sk</a> <a id="1349" href="Ledger.Crypto.html#1320" class="Bound">d</a> <a id="1351" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="1353" href="Ledger.Crypto.html#1330" class="Bound">σ</a> <a id="1355" class="Symbol">→</a> <a id="1357" href="Ledger.Crypto.html#994" class="Field">isSigned</a> <a id="1366" href="Ledger.Crypto.html#1300" class="Bound">vk</a> <a id="1369" href="Ledger.Crypto.html#1320" class="Bound">d</a> <a id="1371" href="Ledger.Crypto.html#1330" class="Bound">σ</a>
<a id="1373" class="Markup">\end{code}</a><a id="1383" class="Background">
\caption{Definitions for the public key signature scheme}
\label{fig:defs:crypto}
\end{figure*}
</a><a id="1480" class="Markup">\begin{code}[hide]</a>
        <a id="1507" class="Keyword">instance</a> <a id="PKKScheme.decEq-VKey"></a><a id="1516" href="Ledger.Crypto.html#1516" class="Field">decEq-VKey</a> <a id="1527" class="Symbol">:</a> <a id="1529" href="Interface.DecEq.html#185" class="Record">DecEq</a> <a id="1535" href="Ledger.Crypto.html#929" class="Field">VKey</a>
                 <a id="PKKScheme.decEq-Sig"></a><a id="1557" href="Ledger.Crypto.html#1557" class="Field">decEq-Sig</a>  <a id="1568" class="Symbol">:</a> <a id="1570" href="Interface.DecEq.html#185" class="Record">DecEq</a> <a id="1576" href="Ledger.Crypto.html#934" class="Field">Sig</a>
                 <a id="PKKScheme.decEq-Ser"></a><a id="1597" href="Ledger.Crypto.html#1597" class="Field">decEq-Ser</a>  <a id="1608" class="Symbol">:</a> <a id="1610" href="Interface.DecEq.html#185" class="Record">DecEq</a> <a id="1616" href="Ledger.Crypto.html#938" class="Field">Ser</a>

<a id="1621" class="Keyword">record</a> <a id="Crypto"></a><a id="1628" href="Ledger.Crypto.html#1628" class="Record">Crypto</a> <a id="1635" class="Symbol">:</a> <a id="1637" href="Agda.Primitive.html#320" class="Primitive">Set₁</a> <a id="1642" class="Keyword">where</a>
  <a id="1650" class="Keyword">field</a> <a id="Crypto.pkk"></a><a id="1656" href="Ledger.Crypto.html#1656" class="Field">pkk</a> <a id="1660" class="Symbol">:</a> <a id="1662" href="Ledger.Crypto.html#747" class="Record">PKKScheme</a>

  <a id="1675" class="Keyword">open</a> <a id="1680" href="Ledger.Crypto.html#747" class="Module">PKKScheme</a> <a id="1690" href="Ledger.Crypto.html#1656" class="Field">pkk</a> <a id="1694" class="Keyword">public</a>

  <a id="1704" class="Keyword">field</a> <a id="Crypto.khs"></a><a id="1710" href="Ledger.Crypto.html#1710" class="Field">khs</a>        <a id="1721" class="Symbol">:</a> <a id="1723" href="Ledger.Crypto.html#190" class="Record">isHashableSet</a> <a id="1737" href="Ledger.Crypto.html#929" class="Function">VKey</a>
        <a id="Crypto.ScriptHash"></a><a id="1750" href="Ledger.Crypto.html#1750" class="Field">ScriptHash</a> <a id="1761" class="Symbol">:</a> <a id="1763" href="Agda.Primitive.html#320" class="Primitive">Set</a>

  <a id="1770" class="Keyword">open</a> <a id="1775" href="Ledger.Crypto.html#190" class="Module">isHashableSet</a> <a id="1789" href="Ledger.Crypto.html#1710" class="Field">khs</a> <a id="1793" class="Keyword">renaming</a> <a id="1802" class="Symbol">(</a><a id="1803" href="Ledger.Crypto.html#235" class="Field">THash</a> <a id="1809" class="Symbol">to</a> <a id="1812" class="Field">KeyHash</a><a id="1819" class="Symbol">)</a> <a id="1821" class="Keyword">public</a>

  <a id="1831" class="Keyword">field</a> <a id="1837" class="Keyword">instance</a> <a id="Crypto.decEq-ScriptHash"></a><a id="1846" href="Ledger.Crypto.html#1846" class="Field">decEq-ScriptHash</a> <a id="1863" class="Symbol">:</a> <a id="1865" href="Interface.DecEq.html#185" class="Record">DecEq</a> <a id="1871" href="Ledger.Crypto.html#1750" class="Field">ScriptHash</a>

<a id="1883" class="Comment">-- TODO: KES and VRF</a>
<a id="1904" class="Markup">\end{code}</a><a id="1914" class="Background">
</a></pre></body></html>