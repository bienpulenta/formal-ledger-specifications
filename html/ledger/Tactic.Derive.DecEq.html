<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Tactic.Derive.DecEq</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">-- Deriving decidable equality. This works in several cases that use</a>
<a id="70" class="Comment">-- mutual recursion, examples are at the bottom.</a>
<a id="119" class="Comment">--</a>
<a id="122" class="Comment">-- TODO: This breaks with:</a>
<a id="149" class="Comment">-- - dependent records, e.g. Product</a>
<a id="186" class="Comment">-- - anything listed in Tactic.Derive</a>
<a id="224" class="Comment">-- - maybe more</a>

<a id="241" class="Symbol">{-#</a> <a id="245" class="Keyword">OPTIONS</a> <a id="253" class="Pragma">-v</a> <a id="256" class="Pragma">allTactics:100</a> <a id="271" class="Symbol">#-}</a>
<a id="275" class="Symbol">{-#</a> <a id="279" class="Keyword">OPTIONS</a> <a id="287" class="Pragma">--safe</a> <a id="294" class="Symbol">#-}</a>
<a id="298" class="Keyword">open</a> <a id="303" class="Keyword">import</a> <a id="310" href="Meta.html" class="Module">Meta</a>

<a id="316" class="Keyword">module</a> <a id="323" href="Tactic.Derive.DecEq.html" class="Module">Tactic.Derive.DecEq</a> <a id="343" class="Keyword">where</a>

<a id="350" class="Keyword">open</a> <a id="355" class="Keyword">import</a> <a id="362" href="MetaPrelude.html" class="Module">MetaPrelude</a>

<a id="375" class="Keyword">open</a> <a id="380" class="Keyword">import</a> <a id="387" href="Reflection.AST.Term.html" class="Module">Reflection.AST.Term</a> <a id="407" class="Keyword">using</a> <a id="413" class="Symbol">(</a><a id="414" href="Reflection.AST.Term.html#5437" class="Function Operator">_≟-Pattern_</a><a id="425" class="Symbol">)</a>

<a id="428" class="Keyword">open</a> <a id="433" class="Keyword">import</a> <a id="440" href="Generics.html" class="Module">Generics</a>

<a id="450" class="Keyword">import</a> <a id="457" href="Data.List.html" class="Module">Data.List</a> <a id="467" class="Symbol">as</a> <a id="470" class="Module">L</a>
<a id="472" class="Keyword">import</a> <a id="479" href="Data.List.NonEmpty.html" class="Module">Data.List.NonEmpty</a> <a id="498" class="Symbol">as</a> <a id="501" class="Module">NE</a>

<a id="505" class="Keyword">open</a> <a id="510" class="Keyword">import</a> <a id="517" href="Relation.Nullary.html" class="Module">Relation.Nullary</a>
<a id="534" class="Keyword">open</a> <a id="539" class="Keyword">import</a> <a id="546" href="Relation.Nullary.Decidable.html" class="Module">Relation.Nullary.Decidable</a>

<a id="574" class="Keyword">module</a> <a id="581" href="Tactic.Derive.DecEq.html#581" class="Module">_</a> <a id="583" class="Keyword">where</a>
  <a id="591" class="Keyword">open</a> <a id="596" class="Keyword">import</a> <a id="603" href="Interface.DecEq.html" class="Module">Interface.DecEq</a> <a id="619" class="Keyword">hiding</a> <a id="626" class="Symbol">(</a><a id="627" href="Interface.DecEq.html#791" class="Function">DecEq-List</a><a id="637" class="Symbol">;</a> <a id="639" href="Interface.DecEq.html#572" class="Function">DecEq-ℕ</a><a id="646" class="Symbol">;</a> <a id="648" href="Interface.DecEq.html#623" class="Function">DecEq-ℤ</a><a id="655" class="Symbol">;</a> <a id="657" href="Interface.DecEq.html#520" class="Function">DecEq-⊤</a><a id="664" class="Symbol">;</a> <a id="666" href="Interface.DecEq.html#691" class="Function">DecEq-Maybe</a><a id="677" class="Symbol">)</a> <a id="679" class="Keyword">public</a>

<a id="687" class="Keyword">open</a> <a id="692" class="Keyword">import</a> <a id="699" href="Tactic.ClauseBuilder.html" class="Module">Tactic.ClauseBuilder</a>
<a id="720" class="Keyword">open</a> <a id="725" class="Keyword">import</a> <a id="732" href="Tactic.Derive.html" class="Module">Tactic.Derive</a> <a id="746" class="Symbol">(</a><a id="747" class="Keyword">quote</a> <a id="753" href="Interface.DecEq.html#185" class="Record">DecEq</a><a id="758" class="Symbol">)</a> <a id="760" class="Symbol">(</a><a id="761" class="Keyword">quote</a> <a id="767" href="Interface.DecEq.html#243" class="Field Operator">_≟_</a><a id="770" class="Symbol">)</a>

<a id="773" class="Keyword">open</a> <a id="778" class="Keyword">import</a> <a id="785" href="Interface.Monad.Instance.html" class="Module">Interface.Monad.Instance</a>
<a id="810" class="Keyword">open</a> <a id="815" class="Keyword">import</a> <a id="822" href="Interface.MonadTC.Instance.html" class="Module">Interface.MonadTC.Instance</a>

<a id="850" class="Keyword">instance</a>
  <a id="861" href="Tactic.Derive.DecEq.html#861" class="Function">_</a> <a id="863" class="Symbol">=</a> <a id="865" href="Tactic.ClauseBuilder.html#10635" class="Function">ContextMonad-MonadTC</a>

<a id="887" class="Keyword">open</a> <a id="892" href="Tactic.ClauseBuilder.html#10865" class="Module">ClauseExprM</a>

<a id="`yes"></a><a id="905" href="Tactic.Derive.DecEq.html#905" class="Function">`yes</a> <a id="`no"></a><a id="910" href="Tactic.Derive.DecEq.html#910" class="Function">`no</a> <a id="914" class="Symbol">:</a> <a id="916" href="Agda.Builtin.Reflection.html#4670" class="Datatype">Term</a> <a id="921" class="Symbol">→</a> <a id="923" href="Agda.Builtin.Reflection.html#4670" class="Datatype">Term</a>
<a id="928" href="Tactic.Derive.DecEq.html#905" class="Function">`yes</a> <a id="933" href="Tactic.Derive.DecEq.html#933" class="Bound">x</a> <a id="935" class="Symbol">=</a> <a id="937" class="Keyword">quote</a> <a id="943" href="Relation.Nullary.Decidable.Core.html#1524" class="InductiveConstructor Operator">_because_</a> <a id="953" href="Generics.Core.html#2150" class="InductiveConstructor Operator">◆⟦</a> <a id="956" class="Keyword">quote</a> <a id="962" href="Agda.Builtin.Bool.html#181" class="InductiveConstructor">true</a>  <a id="968" href="Generics.Core.html#2086" class="InductiveConstructor Operator">◆</a> <a id="970" href="Generics.Core.html#2150" class="InductiveConstructor Operator">∣</a> <a id="972" class="Keyword">quote</a> <a id="978" href="Relation.Nullary.Reflects.html#938" class="InductiveConstructor">ofʸ</a> <a id="982" href="Generics.Core.html#2110" class="InductiveConstructor Operator">◆⟦</a> <a id="985" href="Tactic.Derive.DecEq.html#933" class="Bound">x</a> <a id="987" href="Generics.Core.html#2110" class="InductiveConstructor Operator">⟧</a> <a id="989" href="Generics.Core.html#2150" class="InductiveConstructor Operator">⟧</a>
<a id="991" href="Tactic.Derive.DecEq.html#910" class="Function">`no</a>  <a id="996" href="Tactic.Derive.DecEq.html#996" class="Bound">x</a> <a id="998" class="Symbol">=</a> <a id="1000" class="Keyword">quote</a> <a id="1006" href="Relation.Nullary.Decidable.Core.html#1524" class="InductiveConstructor Operator">_because_</a> <a id="1016" href="Generics.Core.html#2150" class="InductiveConstructor Operator">◆⟦</a> <a id="1019" class="Keyword">quote</a> <a id="1025" href="Agda.Builtin.Bool.html#175" class="InductiveConstructor">false</a> <a id="1031" href="Generics.Core.html#2086" class="InductiveConstructor Operator">◆</a> <a id="1033" href="Generics.Core.html#2150" class="InductiveConstructor Operator">∣</a> <a id="1035" class="Keyword">quote</a> <a id="1041" href="Relation.Nullary.Reflects.html#975" class="InductiveConstructor">ofⁿ</a> <a id="1045" href="Generics.Core.html#2110" class="InductiveConstructor Operator">◆⟦</a> <a id="1048" href="Tactic.Derive.DecEq.html#996" class="Bound">x</a> <a id="1050" href="Generics.Core.html#2110" class="InductiveConstructor Operator">⟧</a> <a id="1052" href="Generics.Core.html#2150" class="InductiveConstructor Operator">⟧</a>

<a id="map&#39;"></a><a id="1055" href="Tactic.Derive.DecEq.html#1055" class="Function">map&#39;</a> <a id="1060" class="Symbol">:</a> <a id="1062" class="Symbol">∀</a> <a id="1064" class="Symbol">{</a><a id="1065" href="Tactic.Derive.DecEq.html#1065" class="Bound">p</a> <a id="1067" href="Tactic.Derive.DecEq.html#1067" class="Bound">q</a><a id="1068" class="Symbol">}</a> <a id="1070" class="Symbol">{</a><a id="1071" href="Tactic.Derive.DecEq.html#1071" class="Bound">P</a> <a id="1073" class="Symbol">:</a> <a id="1075" href="Agda.Primitive.html#320" class="Primitive">Set</a> <a id="1079" href="Tactic.Derive.DecEq.html#1065" class="Bound">p</a><a id="1080" class="Symbol">}</a> <a id="1082" class="Symbol">{</a><a id="1083" href="Tactic.Derive.DecEq.html#1083" class="Bound">Q</a> <a id="1085" class="Symbol">:</a> <a id="1087" href="Agda.Primitive.html#320" class="Primitive">Set</a> <a id="1091" href="Tactic.Derive.DecEq.html#1067" class="Bound">q</a><a id="1092" class="Symbol">}</a> <a id="1094" class="Symbol">→</a> <a id="1096" href="Tactic.Derive.DecEq.html#1071" class="Bound">P</a> <a id="1098" href="Function.Bundles.html#8920" class="Function Operator">⇔</a> <a id="1100" href="Tactic.Derive.DecEq.html#1083" class="Bound">Q</a> <a id="1102" class="Symbol">→</a> <a id="1104" href="Relation.Nullary.Decidable.Core.html#1476" class="Record">Dec</a> <a id="1108" href="Tactic.Derive.DecEq.html#1071" class="Bound">P</a> <a id="1110" class="Symbol">→</a> <a id="1112" href="Relation.Nullary.Decidable.Core.html#1476" class="Record">Dec</a> <a id="1116" href="Tactic.Derive.DecEq.html#1083" class="Bound">Q</a>
<a id="1118" href="Tactic.Derive.DecEq.html#1055" class="Function">map&#39;</a> <a id="1123" class="Keyword">record</a> <a id="1130" class="Symbol">{</a> <a id="1132" href="Function.Bundles.html#4398" class="Field">to</a> <a id="1135" class="Symbol">=</a> <a id="1137" href="Tactic.Derive.DecEq.html#1137" class="Bound">to</a> <a id="1140" class="Symbol">;</a> <a id="1142" href="Function.Bundles.html#4422" class="Field">from</a> <a id="1147" class="Symbol">=</a> <a id="1149" href="Tactic.Derive.DecEq.html#1149" class="Bound">from</a> <a id="1154" class="Symbol">}</a> <a id="1156" class="Symbol">=</a> <a id="1158" href="Relation.Nullary.Decidable.Core.html#4779" class="Function">map′</a> <a id="1163" href="Tactic.Derive.DecEq.html#1137" class="Bound">to</a> <a id="1166" href="Tactic.Derive.DecEq.html#1149" class="Bound">from</a>

<a id="1172" class="Keyword">module</a> <a id="1179" href="Tactic.Derive.DecEq.html#1179" class="Module">_</a> <a id="1181" class="Symbol">(</a><a id="1182" href="Tactic.Derive.DecEq.html#1182" class="Bound">transName</a> <a id="1192" class="Symbol">:</a> <a id="1194" href="Agda.Builtin.Reflection.html#471" class="Postulate">Name</a> <a id="1199" class="Symbol">→</a> <a id="1201" href="Agda.Builtin.Maybe.html#118" class="Datatype">Maybe</a> <a id="1207" href="Agda.Builtin.Reflection.html#471" class="Postulate">Name</a><a id="1211" class="Symbol">)</a> <a id="1213" class="Keyword">where</a>

  <a id="1222" href="Tactic.Derive.DecEq.html#1222" class="Function">eqFromTerm</a> <a id="1233" class="Symbol">:</a> <a id="1235" href="Agda.Builtin.Reflection.html#4670" class="Datatype">Term</a> <a id="1240" class="Symbol">→</a> <a id="1242" href="Agda.Builtin.Reflection.html#4670" class="Datatype">Term</a> <a id="1247" class="Symbol">→</a> <a id="1249" href="Agda.Builtin.Reflection.html#4670" class="Datatype">Term</a> <a id="1254" class="Symbol">→</a> <a id="1256" href="Agda.Builtin.Reflection.html#4670" class="Datatype">Term</a>
  <a id="1263" href="Tactic.Derive.DecEq.html#1222" class="Function">eqFromTerm</a> <a id="1274" class="Symbol">(</a><a id="1275" href="Agda.Builtin.Reflection.html#4928" class="InductiveConstructor">def</a> <a id="1279" href="Tactic.Derive.DecEq.html#1279" class="Bound">n</a> <a id="1281" class="Symbol">_)</a> <a id="1284" href="Tactic.Derive.DecEq.html#1284" class="Bound">t</a> <a id="1286" href="Tactic.Derive.DecEq.html#1286" class="Bound">t&#39;</a> <a id="1289" class="Keyword">with</a> <a id="1294" href="Tactic.Derive.DecEq.html#1182" class="Bound">transName</a> <a id="1304" href="Tactic.Derive.DecEq.html#1279" class="Bound">n</a>
  <a id="1308" class="Symbol">...</a> <a id="1312" class="Symbol">|</a> <a id="1314" href="Agda.Builtin.Maybe.html#156" class="InductiveConstructor">just</a> <a id="1319" href="Tactic.Derive.DecEq.html#1319" class="Bound">n&#39;</a>     <a id="1326" class="Symbol">=</a> <a id="1328" href="Agda.Builtin.Reflection.html#4928" class="InductiveConstructor">def</a> <a id="1332" class="Symbol">(</a><a id="1333" class="Keyword">quote</a> <a id="1339" href="Interface.DecEq.html#243" class="Field Operator">_≟_</a><a id="1342" class="Symbol">)</a> <a id="1344" class="Symbol">(</a><a id="1345" href="Reflection.AST.Argument.html#1419" class="InductiveConstructor">iArg</a> <a id="1350" class="Symbol">(</a><a id="1351" href="Tactic.Derive.DecEq.html#1319" class="Bound">n&#39;</a> <a id="1354" href="Generics.Core.html#1823" class="InductiveConstructor Operator">∙</a><a id="1355" class="Symbol">)</a> <a id="1357" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="1359" href="Reflection.AST.Argument.html#1295" class="InductiveConstructor">vArg</a> <a id="1364" class="Bound">t</a> <a id="1366" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="1368" href="Reflection.AST.Argument.html#1295" class="InductiveConstructor">vArg</a> <a id="1373" class="Bound">t&#39;</a> <a id="1376" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="1378" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a><a id="1380" class="Symbol">)</a>
  <a id="1384" class="Symbol">...</a> <a id="1388" class="Symbol">|</a> <a id="1390" href="Agda.Builtin.Maybe.html#177" class="InductiveConstructor">nothing</a>     <a id="1402" class="Symbol">=</a> <a id="1404" class="Keyword">quote</a> <a id="1410" href="Interface.DecEq.html#243" class="Field Operator">_≟_</a> <a id="1414" href="Generics.Core.html#1887" class="InductiveConstructor Operator">∙⟦</a> <a id="1417" class="Bound">t</a> <a id="1419" href="Generics.Core.html#1887" class="InductiveConstructor Operator">∣</a> <a id="1421" class="Bound">t&#39;</a> <a id="1424" href="Generics.Core.html#1887" class="InductiveConstructor Operator">⟧</a>
  <a id="1428" href="Tactic.Derive.DecEq.html#1222" class="CatchallClause Function">eqFromTerm</a><a id="1438" class="CatchallClause"> </a><a id="1439" class="CatchallClause Symbol">_</a><a id="1440" class="CatchallClause"> </a><a id="1441" href="Tactic.Derive.DecEq.html#1441" class="CatchallClause Bound">t</a><a id="1442" class="CatchallClause"> </a><a id="1443" href="Tactic.Derive.DecEq.html#1443" class="CatchallClause Bound">t&#39;</a> <a id="1446" class="Symbol">=</a> <a id="1448" class="Keyword">quote</a> <a id="1454" href="Interface.DecEq.html#243" class="Field Operator">_≟_</a> <a id="1458" href="Generics.Core.html#1887" class="InductiveConstructor Operator">∙⟦</a> <a id="1461" href="Tactic.Derive.DecEq.html#1441" class="Bound">t</a> <a id="1463" href="Generics.Core.html#1887" class="InductiveConstructor Operator">∣</a> <a id="1465" href="Tactic.Derive.DecEq.html#1443" class="Bound">t&#39;</a> <a id="1468" href="Generics.Core.html#1887" class="InductiveConstructor Operator">⟧</a>

  <a id="1473" href="Tactic.Derive.DecEq.html#1473" class="Function">toDecEqName</a> <a id="1485" class="Symbol">:</a> <a id="1487" href="Tactic.ClauseBuilder.html#1166" class="Function">SinglePattern</a> <a id="1501" class="Symbol">→</a> <a id="1503" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="1508" class="Symbol">(</a><a id="1509" href="Agda.Builtin.Reflection.html#4670" class="Datatype">Term</a> <a id="1514" class="Symbol">→</a> <a id="1516" href="Agda.Builtin.Reflection.html#4670" class="Datatype">Term</a> <a id="1521" class="Symbol">→</a> <a id="1523" href="Agda.Builtin.Reflection.html#4670" class="Datatype">Term</a><a id="1527" class="Symbol">)</a>
  <a id="1531" href="Tactic.Derive.DecEq.html#1473" class="Function">toDecEqName</a> <a id="1543" class="Symbol">(</a><a id="1544" href="Tactic.Derive.DecEq.html#1544" class="Bound">l</a> <a id="1546" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="1548" class="Symbol">_)</a> <a id="1551" class="Symbol">=</a> <a id="1553" href="Data.List.Base.html#1606" class="Function">L.map</a> <a id="1559" class="Symbol">(λ</a> <a id="1562" class="Keyword">where</a> <a id="1568" class="Symbol">(_</a> <a id="1571" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="1573" href="Agda.Builtin.Reflection.html#3715" class="InductiveConstructor">arg</a> <a id="1577" class="Symbol">_</a> <a id="1579" href="Tactic.Derive.DecEq.html#1579" class="Bound">t</a><a id="1580" class="Symbol">)</a> <a id="1582" class="Symbol">→</a> <a id="1584" href="Tactic.Derive.DecEq.html#1222" class="Function">eqFromTerm</a> <a id="1595" href="Tactic.Derive.DecEq.html#1579" class="Bound">t</a><a id="1596" class="Symbol">)</a> <a id="1598" href="Tactic.Derive.DecEq.html#1544" class="Bound">l</a>

  <a id="1603" class="Comment">-- on the diagonal we have one pattern, outside we don&#39;t care</a>
  <a id="1667" class="Comment">-- assume that the types in the pattern are properly normalized</a>
  <a id="1733" href="Tactic.Derive.DecEq.html#1733" class="Function">mapDiag</a> <a id="1741" class="Symbol">:</a> <a id="1743" href="Agda.Builtin.Maybe.html#118" class="Datatype">Maybe</a> <a id="1749" href="Tactic.ClauseBuilder.html#1166" class="Function">SinglePattern</a> <a id="1763" class="Symbol">→</a> <a id="1765" href="Reflection.TCI.html#632" class="Function">TC</a> <a id="1768" href="Agda.Builtin.Reflection.html#4670" class="Datatype">Term</a>
  <a id="1775" href="Tactic.Derive.DecEq.html#1733" class="Function">mapDiag</a> <a id="1783" href="Agda.Builtin.Maybe.html#177" class="InductiveConstructor">nothing</a>          <a id="1800" class="Symbol">=</a> <a id="1802" href="Interface.Monad.html#290" class="Field">return</a> <a id="1809" href="Function.Base.html#1994" class="Function Operator">$</a> <a id="1811" href="Tactic.Derive.DecEq.html#910" class="Function">`no</a> <a id="1815" href="Generics.Core.html#1408" class="InductiveConstructor Operator">`λ⦅</a> <a id="1819" href="Data.List.Base.html#5219" class="Function Operator">[</a> <a id="1821" class="Symbol">(</a><a id="1822" class="String">&quot;&quot;</a> <a id="1825" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="1827" href="Generics.Core.html#304" class="InductiveConstructor">vArg?</a><a id="1832" class="Symbol">)</a> <a id="1834" href="Data.List.Base.html#5219" class="Function Operator">]</a> <a id="1836" href="Generics.Core.html#1408" class="InductiveConstructor Operator">⦆∅</a>
  <a id="1841" href="Tactic.Derive.DecEq.html#1733" class="Function">mapDiag</a> <a id="1849" class="Symbol">(</a><a id="1850" href="Agda.Builtin.Maybe.html#156" class="InductiveConstructor">just</a> <a id="1855" href="Tactic.Derive.DecEq.html#1855" class="Bound">p</a><a id="1856" class="Symbol">@(</a><a id="1858" href="Tactic.Derive.DecEq.html#1858" class="Bound">l</a> <a id="1860" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="1862" class="Symbol">_))</a> <a id="1866" class="Symbol">=</a> <a id="1868" class="Keyword">let</a> <a id="1872" href="Tactic.Derive.DecEq.html#1872" class="Bound">k</a> <a id="1874" class="Symbol">=</a> <a id="1876" href="Data.List.Base.html#5058" class="Function">length</a> <a id="1883" href="Tactic.Derive.DecEq.html#1858" class="Bound">l</a> <a id="1885" class="Keyword">in</a> <a id="1888" class="Keyword">do</a>
    <a id="1895" href="Tactic.Derive.DecEq.html#1895" class="Bound">typeList</a> <a id="1904" href="Interface.Monad.html#311" class="Field Operator">←</a> <a id="1906" href="Interface.Monad.html#824" class="Function">traverseList</a> <a id="1919" href="Interface.MonadTC.html#1621" class="Field">inferType</a> <a id="1929" class="Symbol">(</a><a id="1930" href="Data.List.Base.html#6059" class="Function">applyDownFrom</a> <a id="1944" href="Generics.Core.html#376" class="InductiveConstructor">♯</a> <a id="1946" class="Symbol">(</a><a id="1947" href="Data.List.Base.html#5058" class="Function">length</a> <a id="1954" href="Tactic.Derive.DecEq.html#1858" class="Bound">l</a><a id="1955" class="Symbol">))</a>
    <a id="1962" href="Interface.Monad.html#290" class="Field">return</a> <a id="1969" href="Function.Base.html#1994" class="Function Operator">$</a> <a id="1971" class="Keyword">quote</a> <a id="1977" href="Tactic.Derive.DecEq.html#1055" class="Function">map&#39;</a> <a id="1982" href="Generics.Core.html#1887" class="InductiveConstructor Operator">∙⟦</a> <a id="1985" href="Tactic.Derive.DecEq.html#2291" class="Function">genEquiv</a> <a id="1994" href="Tactic.Derive.DecEq.html#1872" class="Bound">k</a> <a id="1996" href="Generics.Core.html#1887" class="InductiveConstructor Operator">∣</a> <a id="1998" href="Tactic.Derive.DecEq.html#2052" class="Function">genPf</a> <a id="2004" href="Tactic.Derive.DecEq.html#1872" class="Bound">k</a> <a id="2006" class="Symbol">(</a><a id="2007" href="Data.List.Base.html#1606" class="Function">L.map</a> <a id="2013" href="Tactic.Derive.DecEq.html#1222" class="Function">eqFromTerm</a> <a id="2024" href="Tactic.Derive.DecEq.html#1895" class="Bound">typeList</a><a id="2032" class="Symbol">)</a> <a id="2034" href="Generics.Core.html#1887" class="InductiveConstructor Operator">⟧</a>
    <a id="2040" class="Keyword">where</a>
      <a id="2052" href="Tactic.Derive.DecEq.html#2052" class="Function">genPf</a> <a id="2058" class="Symbol">:</a> <a id="2060" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a> <a id="2062" class="Symbol">→</a> <a id="2064" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="2069" class="Symbol">(</a><a id="2070" href="Agda.Builtin.Reflection.html#4670" class="Datatype">Term</a> <a id="2075" class="Symbol">→</a> <a id="2077" href="Agda.Builtin.Reflection.html#4670" class="Datatype">Term</a> <a id="2082" class="Symbol">→</a> <a id="2084" href="Agda.Builtin.Reflection.html#4670" class="Datatype">Term</a><a id="2088" class="Symbol">)</a> <a id="2090" class="Symbol">→</a> <a id="2092" href="Agda.Builtin.Reflection.html#4670" class="Datatype">Term</a>
      <a id="2103" href="Tactic.Derive.DecEq.html#2052" class="Function">genPf</a> <a id="2109" href="Tactic.Derive.DecEq.html#2109" class="Bound">k</a> <a id="2111" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a>      <a id="2119" class="Symbol">=</a> <a id="2121" href="Tactic.Derive.DecEq.html#905" class="Function">`yes</a> <a id="2126" class="Symbol">(</a><a id="2127" class="Keyword">quote</a> <a id="2133" href="Agda.Builtin.Unit.html#195" class="InductiveConstructor">tt</a> <a id="2136" href="Generics.Core.html#2086" class="InductiveConstructor Operator">◆</a><a id="2137" class="Symbol">)</a>
      <a id="2145" href="Tactic.Derive.DecEq.html#2052" class="Function">genPf</a> <a id="2151" href="Tactic.Derive.DecEq.html#2151" class="Bound">k</a> <a id="2153" class="Symbol">(</a><a id="2154" href="Tactic.Derive.DecEq.html#2154" class="Bound">n</a> <a id="2156" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="2158" href="Tactic.Derive.DecEq.html#2158" class="Bound">l</a><a id="2159" class="Symbol">)</a> <a id="2161" class="Symbol">=</a> <a id="2163" class="Keyword">quote</a> <a id="2169" href="Relation.Nullary.Decidable.Core.html#2255" class="Function Operator">_×-dec_</a> <a id="2177" href="Generics.Core.html#1887" class="InductiveConstructor Operator">∙⟦</a> <a id="2180" href="Tactic.Derive.DecEq.html#2052" class="Function">genPf</a> <a id="2186" href="Tactic.Derive.DecEq.html#2151" class="Bound">k</a> <a id="2188" href="Tactic.Derive.DecEq.html#2158" class="Bound">l</a> <a id="2190" href="Generics.Core.html#1887" class="InductiveConstructor Operator">∣</a> <a id="2192" href="Tactic.Derive.DecEq.html#2154" class="Bound">n</a> <a id="2194" class="Symbol">(</a><a id="2195" href="Generics.Core.html#376" class="InductiveConstructor">♯</a> <a id="2197" class="Symbol">(</a><a id="2198" href="Data.List.Base.html#5058" class="Function">length</a> <a id="2205" href="Tactic.Derive.DecEq.html#2158" class="Bound">l</a><a id="2206" class="Symbol">))</a> <a id="2209" class="Symbol">(</a><a id="2210" href="Generics.Core.html#376" class="InductiveConstructor">♯</a> <a id="2212" class="Symbol">(</a><a id="2213" href="Data.List.Base.html#5058" class="Function">length</a> <a id="2220" href="Tactic.Derive.DecEq.html#2158" class="Bound">l</a> <a id="2222" href="Agda.Builtin.Nat.html#319" class="Primitive Operator">+</a> <a id="2224" href="Tactic.Derive.DecEq.html#2151" class="Bound">k</a><a id="2225" class="Symbol">))</a> <a id="2228" href="Generics.Core.html#1887" class="InductiveConstructor Operator">⟧</a>

      <a id="2237" class="Comment">-- c x1 .. xn ≡ c y1 .. yn ⇔ x1 ≡ y1 .. xn ≡ yn</a>
      <a id="2291" href="Tactic.Derive.DecEq.html#2291" class="Function">genEquiv</a> <a id="2300" class="Symbol">:</a> <a id="2302" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a> <a id="2304" class="Symbol">→</a> <a id="2306" href="Agda.Builtin.Reflection.html#4670" class="Datatype">Term</a>
      <a id="2317" href="Tactic.Derive.DecEq.html#2291" class="Function">genEquiv</a> <a id="2326" href="Tactic.Derive.DecEq.html#2326" class="Bound">n</a> <a id="2328" class="Symbol">=</a> <a id="2330" class="Keyword">quote</a> <a id="2336" href="Function.Bundles.html#10043" class="Function">mk⇔</a> <a id="2340" href="Generics.Core.html#1887" class="InductiveConstructor Operator">∙⟦</a> <a id="2343" href="Generics.Core.html#1495" class="InductiveConstructor Operator">`λ⟦</a> <a id="2347" href="Tactic.Derive.DecEq.html#2438" class="Function">reflPattern</a> <a id="2359" href="Tactic.Derive.DecEq.html#2326" class="Bound">n</a> <a id="2361" href="Generics.Core.html#1495" class="InductiveConstructor Operator">⇒</a> <a id="2363" class="Keyword">quote</a> <a id="2369" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a> <a id="2374" href="Generics.Core.html#2086" class="InductiveConstructor Operator">◆</a> <a id="2376" href="Generics.Core.html#1495" class="InductiveConstructor Operator">⟧</a> <a id="2378" href="Generics.Core.html#1887" class="InductiveConstructor Operator">∣</a> <a id="2380" href="Generics.Core.html#1495" class="InductiveConstructor Operator">`λ⟦</a> <a id="2384" class="Keyword">quote</a> <a id="2390" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a> <a id="2395" href="Generics.Core.html#2204" class="InductiveConstructor Operator">◇</a> <a id="2397" href="Generics.Core.html#1495" class="InductiveConstructor Operator">⇒</a> <a id="2399" href="Tactic.Derive.DecEq.html#2594" class="Function">reflTerm</a> <a id="2408" href="Tactic.Derive.DecEq.html#2326" class="Bound">n</a> <a id="2410" href="Generics.Core.html#1495" class="InductiveConstructor Operator">⟧</a> <a id="2412" href="Generics.Core.html#1887" class="InductiveConstructor Operator">⟧</a>
        <a id="2422" class="Keyword">where</a>
          <a id="2438" href="Tactic.Derive.DecEq.html#2438" class="Function">reflPattern</a> <a id="2450" class="Symbol">:</a> <a id="2452" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a> <a id="2454" class="Symbol">→</a> <a id="2456" href="Agda.Builtin.Reflection.html#4708" class="Datatype">Pattern</a>
          <a id="2474" href="Tactic.Derive.DecEq.html#2438" class="Function">reflPattern</a> <a id="2486" class="Number">0</a>       <a id="2494" class="Symbol">=</a> <a id="2496" class="Keyword">quote</a> <a id="2502" href="Agda.Builtin.Unit.html#195" class="InductiveConstructor">tt</a> <a id="2505" href="Generics.Core.html#2204" class="InductiveConstructor Operator">◇</a>
          <a id="2517" href="Tactic.Derive.DecEq.html#2438" class="Function">reflPattern</a> <a id="2529" class="Symbol">(</a><a id="2530" href="Agda.Builtin.Nat.html#217" class="InductiveConstructor">suc</a> <a id="2534" href="Tactic.Derive.DecEq.html#2534" class="Bound">n</a><a id="2535" class="Symbol">)</a> <a id="2537" class="Symbol">=</a> <a id="2539" class="Keyword">quote</a> <a id="2545" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">_,_</a> <a id="2549" href="Generics.Core.html#2284" class="InductiveConstructor Operator">◇⟦</a> <a id="2552" href="Tactic.Derive.DecEq.html#2438" class="Function">reflPattern</a> <a id="2564" href="Tactic.Derive.DecEq.html#2534" class="Bound">n</a> <a id="2566" href="Generics.Core.html#2284" class="InductiveConstructor Operator">∣</a> <a id="2568" class="Keyword">quote</a> <a id="2574" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a> <a id="2579" href="Generics.Core.html#2204" class="InductiveConstructor Operator">◇</a> <a id="2581" href="Generics.Core.html#2284" class="InductiveConstructor Operator">⟧</a>

          <a id="2594" href="Tactic.Derive.DecEq.html#2594" class="Function">reflTerm</a> <a id="2603" class="Symbol">:</a> <a id="2605" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a> <a id="2607" class="Symbol">→</a> <a id="2609" href="Agda.Builtin.Reflection.html#4670" class="Datatype">Term</a>
          <a id="2624" href="Tactic.Derive.DecEq.html#2594" class="Function">reflTerm</a> <a id="2633" class="Number">0</a>       <a id="2641" class="Symbol">=</a> <a id="2643" class="Keyword">quote</a> <a id="2649" href="Agda.Builtin.Unit.html#195" class="InductiveConstructor">tt</a> <a id="2652" href="Generics.Core.html#2086" class="InductiveConstructor Operator">◆</a>
          <a id="2664" href="Tactic.Derive.DecEq.html#2594" class="Function">reflTerm</a> <a id="2673" class="Symbol">(</a><a id="2674" href="Agda.Builtin.Nat.html#217" class="InductiveConstructor">suc</a> <a id="2678" href="Tactic.Derive.DecEq.html#2678" class="Bound">n</a><a id="2679" class="Symbol">)</a> <a id="2681" class="Symbol">=</a> <a id="2683" class="Keyword">quote</a> <a id="2689" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">_,_</a> <a id="2693" href="Generics.Core.html#2150" class="InductiveConstructor Operator">◆⟦</a> <a id="2696" href="Tactic.Derive.DecEq.html#2594" class="Function">reflTerm</a> <a id="2705" href="Tactic.Derive.DecEq.html#2678" class="Bound">n</a> <a id="2707" href="Generics.Core.html#2150" class="InductiveConstructor Operator">∣</a> <a id="2709" class="Keyword">quote</a> <a id="2715" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a> <a id="2720" href="Generics.Core.html#2086" class="InductiveConstructor Operator">◆</a> <a id="2722" href="Generics.Core.html#2150" class="InductiveConstructor Operator">⟧</a>

  <a id="2727" href="Tactic.Derive.DecEq.html#2727" class="Function">toMapDiag</a> <a id="2737" class="Symbol">:</a> <a id="2739" href="Tactic.ClauseBuilder.html#1166" class="Function">SinglePattern</a> <a id="2753" class="Symbol">→</a> <a id="2755" href="Tactic.ClauseBuilder.html#1166" class="Function">SinglePattern</a> <a id="2769" class="Symbol">→</a> <a id="2771" href="Data.List.NonEmpty.Base.html#1267" class="Record">NE.List⁺</a> <a id="2780" href="Tactic.ClauseBuilder.html#1166" class="Function">SinglePattern</a> <a id="2794" href="Data.Product.Base.html#1109" class="Function Operator">×</a> <a id="2796" href="Reflection.TCI.html#632" class="Function">TC</a> <a id="2799" class="Symbol">(</a><a id="2800" href="Tactic.ClauseBuilder.html#5656" class="Datatype">ClauseExpr</a> <a id="2811" href="Data.Sum.Base.html#616" class="Datatype Operator">⊎</a> <a id="2813" href="Agda.Builtin.Maybe.html#118" class="Datatype">Maybe</a> <a id="2819" href="Agda.Builtin.Reflection.html#4670" class="Datatype">Term</a><a id="2823" class="Symbol">)</a>
  <a id="2827" href="Tactic.Derive.DecEq.html#2727" class="Function">toMapDiag</a> <a id="2837" href="Tactic.Derive.DecEq.html#2837" class="Bound">p</a><a id="2838" class="Symbol">@(_</a> <a id="2842" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2844" href="Agda.Builtin.Reflection.html#3715" class="InductiveConstructor">arg</a> <a id="2848" class="Symbol">_</a> <a id="2850" href="Tactic.Derive.DecEq.html#2850" class="Bound">p₁</a><a id="2852" class="Symbol">)</a> <a id="2854" href="Tactic.Derive.DecEq.html#2854" class="Bound">p&#39;</a><a id="2856" class="Symbol">@(_</a> <a id="2860" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2862" href="Agda.Builtin.Reflection.html#3715" class="InductiveConstructor">arg</a> <a id="2866" class="Symbol">_</a> <a id="2868" href="Tactic.Derive.DecEq.html#2868" class="Bound">p₂</a><a id="2870" class="Symbol">)</a> <a id="2872" class="Symbol">=</a>
    <a id="2878" class="Symbol">(</a><a id="2879" href="Tactic.Derive.DecEq.html#2837" class="Bound">p</a> <a id="2881" href="Data.List.NonEmpty.Base.html#1313" class="InductiveConstructor Operator">NE.∷</a> <a id="2886" href="Data.List.Base.html#5219" class="Function Operator">[</a> <a id="2888" href="Tactic.Derive.DecEq.html#2854" class="Bound">p&#39;</a> <a id="2891" href="Data.List.Base.html#5219" class="Function Operator">]</a> <a id="2893" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="2895" href="Tactic.ClauseBuilder.html#12783" class="Function">finishMatch</a> <a id="2907" class="Symbol">(</a><a id="2908" href="Data.Bool.Base.html#1283" class="Function Operator">if</a> <a id="2911" href="Relation.Nullary.Decidable.Core.html#3274" class="Function Operator">⌊</a> <a id="2913" href="Tactic.Derive.DecEq.html#2850" class="Bound">p₁</a> <a id="2916" href="Reflection.AST.Term.html#5437" class="Function Operator">≟-Pattern</a> <a id="2926" href="Tactic.Derive.DecEq.html#2868" class="Bound">p₂</a> <a id="2929" href="Relation.Nullary.Decidable.Core.html#3274" class="Function Operator">⌋</a> <a id="2931" href="Data.Bool.Base.html#1283" class="Function Operator">then</a> <a id="2936" href="Tactic.Derive.DecEq.html#1733" class="Function">mapDiag</a> <a id="2944" class="Symbol">(</a><a id="2945" href="Agda.Builtin.Maybe.html#156" class="InductiveConstructor">just</a> <a id="2950" href="Tactic.Derive.DecEq.html#2837" class="Bound">p</a><a id="2951" class="Symbol">)</a> <a id="2953" href="Data.Bool.Base.html#1283" class="Function Operator">else</a> <a id="2958" href="Tactic.Derive.DecEq.html#1733" class="Function">mapDiag</a> <a id="2966" href="Agda.Builtin.Maybe.html#177" class="InductiveConstructor">nothing</a><a id="2973" class="Symbol">))</a>

<a id="2977" class="Keyword">module</a> <a id="2984" href="Tactic.Derive.DecEq.html#2984" class="Module">_</a> <a id="2986" class="Symbol">⦃</a> <a id="2988" href="Tactic.Derive.DecEq.html#2988" class="Bound">_</a> <a id="2990" class="Symbol">:</a> <a id="2992" href="Reflection.Debug.html#2344" class="Record">DebugOptions</a> <a id="3005" class="Symbol">⦄</a> <a id="3007" class="Keyword">where</a>
  <a id="3015" href="Tactic.Derive.DecEq.html#3015" class="Function">derive-DecEq</a> <a id="3028" class="Symbol">:</a> <a id="3030" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="3035" class="Symbol">(</a><a id="3036" href="Agda.Builtin.Reflection.html#471" class="Postulate">Name</a> <a id="3041" href="Data.Product.Base.html#1109" class="Function Operator">×</a> <a id="3043" href="Agda.Builtin.Reflection.html#471" class="Postulate">Name</a><a id="3047" class="Symbol">)</a> <a id="3049" class="Symbol">→</a> <a id="3051" href="Generics.Core.html#2484" class="Function">UnquoteDecl</a>
  <a id="3065" href="Tactic.Derive.DecEq.html#3015" class="Function">derive-DecEq</a> <a id="3078" class="Symbol">=</a> <a id="3080" href="Tactic.Derive.html#4936" class="Function">derive-Class</a> <a id="3093" class="Number">0</a> <a id="3095" class="Symbol">(λ</a> <a id="3098" href="Tactic.Derive.DecEq.html#3098" class="Bound">transName</a> <a id="3108" href="Tactic.Derive.DecEq.html#3108" class="Bound">ps</a> <a id="3111" class="Symbol">→</a> <a id="3113" href="Data.List.Base.html#2327" class="Function">cartesianProductWith</a> <a id="3134" class="Symbol">(</a><a id="3135" href="Tactic.Derive.DecEq.html#2727" class="Function">toMapDiag</a> <a id="3145" href="Tactic.Derive.DecEq.html#3098" class="Bound">transName</a><a id="3154" class="Symbol">)</a> <a id="3156" href="Tactic.Derive.DecEq.html#3108" class="Bound">ps</a> <a id="3159" href="Tactic.Derive.DecEq.html#3108" class="Bound">ps</a><a id="3161" class="Symbol">)</a>

<a id="3164" class="Keyword">private</a>
  <a id="3174" class="Keyword">open</a> <a id="3179" class="Keyword">import</a> <a id="3186" href="Tactic.Derive.TestTypes.html" class="Module">Tactic.Derive.TestTypes</a>
  <a id="3212" class="Keyword">open</a> <a id="3217" class="Keyword">import</a> <a id="3224" href="Tactic.Defaults.html" class="Module">Tactic.Defaults</a>

  <a id="3243" class="Keyword">unquoteDecl</a> <a id="DecEq-These"></a><a id="3255" href="Tactic.Derive.DecEq.html#3255" class="Function">DecEq-These</a> <a id="3267" class="Symbol">=</a> <a id="3269" href="Tactic.Derive.DecEq.html#3015" class="Function">derive-DecEq</a> <a id="3282" href="Data.List.Base.html#5219" class="Function Operator">[</a> <a id="3284" class="Symbol">(</a><a id="3285" class="Keyword">quote</a> <a id="3291" href="Data.These.Base.html#528" class="Datatype">These</a> <a id="3297" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="3299" href="Tactic.Derive.DecEq.html#3255" class="Function">DecEq-These</a><a id="3310" class="Symbol">)</a> <a id="3312" href="Data.List.Base.html#5219" class="Function Operator">]</a>

  <a id="3317" class="Keyword">unquoteDecl</a> <a id="DecEq-⊎"></a><a id="3329" href="Tactic.Derive.DecEq.html#3329" class="Function">DecEq-⊎</a> <a id="3337" class="Symbol">=</a> <a id="3339" href="Tactic.Derive.DecEq.html#3015" class="Function">derive-DecEq</a> <a id="3352" href="Data.List.Base.html#5219" class="Function Operator">[</a> <a id="3354" class="Symbol">(</a><a id="3355" class="Keyword">quote</a> <a id="3361" href="Data.Sum.Base.html#616" class="Datatype Operator">_⊎_</a> <a id="3365" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="3367" href="Tactic.Derive.DecEq.html#3329" class="Function">DecEq-⊎</a><a id="3374" class="Symbol">)</a> <a id="3376" href="Data.List.Base.html#5219" class="Function Operator">]</a>

  <a id="3381" class="Keyword">unquoteDecl</a> <a id="DecEq-Bool"></a><a id="3393" href="Tactic.Derive.DecEq.html#3393" class="Function">DecEq-Bool</a> <a id="DecEq-ℤ"></a><a id="3404" href="Tactic.Derive.DecEq.html#3404" class="Function">DecEq-ℤ</a> <a id="DecEq-List"></a><a id="3412" href="Tactic.Derive.DecEq.html#3412" class="Function">DecEq-List</a> <a id="DecEq-Maybe"></a><a id="3423" href="Tactic.Derive.DecEq.html#3423" class="Function">DecEq-Maybe</a> <a id="DecEq-ℕ"></a><a id="3435" href="Tactic.Derive.DecEq.html#3435" class="Function">DecEq-ℕ</a> <a id="DecEq-Sign"></a><a id="3443" href="Tactic.Derive.DecEq.html#3443" class="Function">DecEq-Sign</a> <a id="DecEq-⊤"></a><a id="3454" href="Tactic.Derive.DecEq.html#3454" class="Function">DecEq-⊤</a> <a id="3462" class="Symbol">=</a> <a id="3464" href="Tactic.Derive.DecEq.html#3015" class="Function">derive-DecEq</a> <a id="3477" class="Symbol">((</a><a id="3479" class="Keyword">quote</a> <a id="3485" href="Agda.Builtin.Bool.html#156" class="Datatype">Bool</a> <a id="3490" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="3492" href="Tactic.Derive.DecEq.html#3393" class="Function">DecEq-Bool</a><a id="3502" class="Symbol">)</a> <a id="3504" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="3506" class="Symbol">(</a><a id="3507" class="Keyword">quote</a> <a id="3513" href="Agda.Builtin.Int.html#228" class="Datatype">ℤ</a> <a id="3515" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="3517" href="Tactic.Derive.DecEq.html#3404" class="Function">DecEq-ℤ</a><a id="3524" class="Symbol">)</a> <a id="3526" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="3528" class="Symbol">(</a><a id="3529" class="Keyword">quote</a> <a id="3535" href="Agda.Builtin.List.html#130" class="Datatype">List</a> <a id="3540" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="3542" href="Tactic.Derive.DecEq.html#3412" class="Function">DecEq-List</a><a id="3552" class="Symbol">)</a> <a id="3554" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="3556" class="Symbol">(</a><a id="3557" class="Keyword">quote</a> <a id="3563" href="Agda.Builtin.Maybe.html#118" class="Datatype">Maybe</a> <a id="3569" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="3571" href="Tactic.Derive.DecEq.html#3423" class="Function">DecEq-Maybe</a><a id="3582" class="Symbol">)</a> <a id="3584" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="3586" class="Symbol">(</a><a id="3587" class="Keyword">quote</a> <a id="3593" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a> <a id="3595" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="3597" href="Tactic.Derive.DecEq.html#3435" class="Function">DecEq-ℕ</a><a id="3604" class="Symbol">)</a> <a id="3606" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="3608" class="Symbol">(</a><a id="3609" class="Keyword">quote</a> <a id="3615" href="Data.Sign.Base.html#514" class="Datatype">Sign</a> <a id="3620" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="3622" href="Tactic.Derive.DecEq.html#3443" class="Function">DecEq-Sign</a><a id="3632" class="Symbol">)</a> <a id="3634" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="3636" class="Symbol">(</a><a id="3637" class="Keyword">quote</a> <a id="3643" href="Agda.Builtin.Unit.html#158" class="Record">⊤</a> <a id="3645" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="3647" href="Tactic.Derive.DecEq.html#3454" class="Function">DecEq-⊤</a><a id="3654" class="Symbol">)</a> <a id="3656" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="3658" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a><a id="3660" class="Symbol">)</a>

  <a id="3665" class="Keyword">unquoteDecl</a> <a id="DecEq-Fin"></a><a id="3677" href="Tactic.Derive.DecEq.html#3677" class="Function">DecEq-Fin</a> <a id="3687" class="Symbol">=</a> <a id="3689" href="Tactic.Derive.DecEq.html#3015" class="Function">derive-DecEq</a> <a id="3702" href="Data.List.Base.html#5219" class="Function Operator">[</a> <a id="3704" class="Symbol">(</a><a id="3705" class="Keyword">quote</a> <a id="3711" href="Data.Fin.Base.html#1298" class="Datatype">Fin</a> <a id="3715" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="3717" href="Tactic.Derive.DecEq.html#3677" class="Function">DecEq-Fin</a><a id="3726" class="Symbol">)</a> <a id="3728" href="Data.List.Base.html#5219" class="Function Operator">]</a>

  <a id="3733" class="Comment">-- this doesn&#39;t work since the clause builder machinery doesn&#39;t deal</a>
  <a id="3804" class="Comment">-- with absurd patterns yet</a>

  <a id="3835" class="Comment">--unquoteDecl DecEq-Vec = derive-DecEq [ (quote Vec , DecEq-Vec) ]</a>

  <a id="3905" class="Keyword">unquoteDecl</a> <a id="DecEq-E1"></a><a id="3917" href="Tactic.Derive.DecEq.html#3917" class="Function">DecEq-E1</a> <a id="3926" class="Symbol">=</a> <a id="3928" href="Tactic.Derive.DecEq.html#3015" class="Function">derive-DecEq</a> <a id="3941" href="Data.List.Base.html#5219" class="Function Operator">[</a> <a id="3943" class="Symbol">(</a><a id="3944" class="Keyword">quote</a> <a id="3950" href="Tactic.Derive.TestTypes.html#197" class="Datatype">E1</a> <a id="3953" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="3955" href="Tactic.Derive.DecEq.html#3917" class="Function">DecEq-E1</a><a id="3963" class="Symbol">)</a> <a id="3965" href="Data.List.Base.html#5219" class="Function Operator">]</a>
  <a id="3969" class="Keyword">unquoteDecl</a> <a id="DecEq-E2"></a><a id="3981" href="Tactic.Derive.DecEq.html#3981" class="Function">DecEq-E2</a> <a id="3990" class="Symbol">=</a> <a id="3992" href="Tactic.Derive.DecEq.html#3015" class="Function">derive-DecEq</a> <a id="4005" href="Data.List.Base.html#5219" class="Function Operator">[</a> <a id="4007" class="Symbol">(</a><a id="4008" class="Keyword">quote</a> <a id="4014" href="Tactic.Derive.TestTypes.html#302" class="Datatype">E2</a> <a id="4017" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="4019" href="Tactic.Derive.DecEq.html#3981" class="Function">DecEq-E2</a><a id="4027" class="Symbol">)</a> <a id="4029" href="Data.List.Base.html#5219" class="Function Operator">]</a>

  <a id="4034" class="Comment">-- this uses mutual recursion with List E3</a>
  <a id="4079" class="Keyword">unquoteDecl</a> <a id="DecEq-E3"></a><a id="4091" href="Tactic.Derive.DecEq.html#4091" class="Function">DecEq-E3</a> <a id="4100" class="Symbol">=</a> <a id="4102" href="Tactic.Derive.DecEq.html#3015" class="Function">derive-DecEq</a> <a id="4115" href="Data.List.Base.html#5219" class="Function Operator">[</a> <a id="4117" class="Symbol">(</a><a id="4118" class="Keyword">quote</a> <a id="4124" href="Tactic.Derive.TestTypes.html#380" class="Datatype">E3</a> <a id="4127" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="4129" href="Tactic.Derive.DecEq.html#4091" class="Function">DecEq-E3</a><a id="4137" class="Symbol">)</a> <a id="4139" href="Data.List.Base.html#5219" class="Function Operator">]</a>
  <a id="4143" class="Comment">-- unquoteDecl DecEq-E4 = derive-DecEq [ (quote E4 , DecEq-E4) ]</a>

  <a id="4211" class="Keyword">unquoteDecl</a> <a id="DecEq-R1"></a><a id="4223" href="Tactic.Derive.DecEq.html#4223" class="Function">DecEq-R1</a> <a id="4232" class="Symbol">=</a> <a id="4234" href="Tactic.Derive.DecEq.html#3015" class="Function">derive-DecEq</a> <a id="4247" href="Data.List.Base.html#5219" class="Function Operator">[</a> <a id="4249" class="Symbol">(</a><a id="4250" class="Keyword">quote</a> <a id="4256" href="Tactic.Derive.TestTypes.html#590" class="Record">R1</a> <a id="4259" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="4261" href="Tactic.Derive.DecEq.html#4223" class="Function">DecEq-R1</a><a id="4269" class="Symbol">)</a> <a id="4271" href="Data.List.Base.html#5219" class="Function Operator">]</a>
  <a id="4275" class="Keyword">unquoteDecl</a> <a id="DecEq-R2"></a><a id="4287" href="Tactic.Derive.DecEq.html#4287" class="Function">DecEq-R2</a> <a id="4296" class="Symbol">=</a> <a id="4298" href="Tactic.Derive.DecEq.html#3015" class="Function">derive-DecEq</a> <a id="4311" href="Data.List.Base.html#5219" class="Function Operator">[</a> <a id="4313" class="Symbol">(</a><a id="4314" class="Keyword">quote</a> <a id="4320" href="Tactic.Derive.TestTypes.html#651" class="Record">R2</a> <a id="4323" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="4325" href="Tactic.Derive.DecEq.html#4287" class="Function">DecEq-R2</a><a id="4333" class="Symbol">)</a> <a id="4335" href="Data.List.Base.html#5219" class="Function Operator">]</a>

  <a id="4340" class="Keyword">unquoteDecl</a> <a id="DecEq-M₁"></a><a id="4352" href="Tactic.Derive.DecEq.html#4352" class="Function">DecEq-M₁</a> <a id="DecEq-M₂"></a><a id="4361" href="Tactic.Derive.DecEq.html#4361" class="Function">DecEq-M₂</a> <a id="4370" class="Symbol">=</a> <a id="4372" href="Tactic.Derive.DecEq.html#3015" class="Function">derive-DecEq</a> <a id="4385" href="Function.Base.html#1994" class="Function Operator">$</a> <a id="4387" class="Symbol">(</a><a id="4388" class="Keyword">quote</a> <a id="4394" href="Tactic.Derive.TestTypes.html#798" class="Datatype">M₁</a> <a id="4397" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="4399" href="Tactic.Derive.DecEq.html#4352" class="Function">DecEq-M₁</a><a id="4407" class="Symbol">)</a> <a id="4409" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="4411" class="Symbol">(</a><a id="4412" class="Keyword">quote</a> <a id="4418" href="Tactic.Derive.TestTypes.html#812" class="Datatype">M₂</a> <a id="4421" href="Agda.Builtin.Sigma.html#218" class="InductiveConstructor Operator">,</a> <a id="4423" href="Tactic.Derive.DecEq.html#4361" class="Function">DecEq-M₂</a><a id="4431" class="Symbol">)</a> <a id="4433" href="Agda.Builtin.List.html#182" class="InductiveConstructor Operator">∷</a> <a id="4435" href="Agda.Builtin.List.html#167" class="InductiveConstructor">[]</a>

  <a id="4441" class="Comment">-- Expected: DecEq-Term DecEq-Product</a>
</pre></body></html>